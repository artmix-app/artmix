<!DOCTYPE html>
<html lang="ko">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8" />
    <title>ë¯¸ìˆ  ì‘í’ˆ ì¶”ì²œ í”„ë¡œê·¸ë¨ (ArtMix + ê³„ì •ë³„ ë‚˜ë§Œì˜ ê³µê°„)</title>
    <style>
        /* ArtMix ë””ìì¸ ìŠ¤íƒ€ì¼ */
        body {
            margin: 0;
            font-family: "ë§‘ì€ ê³ ë”•", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f5f7fb;
        }

        header {
            background: #283593;
            color: white;
            padding: 16px 24px 8px;
        }

        header h1 {
            margin: 0;
            font-size: 22px;
        }

        header p {
            margin: 4px 0 0;
            font-size: 13px;
            opacity: 0.9;
        }

        /* ğŸ” ë¡œê·¸ì¸ ë°•ìŠ¤ */
        #authArea {
            margin-top: 10px;
            font-size: 11px;
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            align-items: center;
        }

        #authArea input[type="email"],
        #authArea input[type="password"] {
            padding: 4px 6px;
            border-radius: 6px;
            border: 1px solid #c5cae9;
            font-size: 11px;
        }

        #authStatus {
            margin-right: 4px;
        }

        main.app-container {
            max-width: 1400px;
            margin: 20px auto;
            padding: 0 20px 24px;
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 16px;
        }
        
        @media (max-width: 1024px) {
            main.app-container {
                grid-template-columns: 1fr;
            }
        }
        
        .main-content {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .panel {
            background: white;
            border-radius: 10px;
            padding: 12px 14px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.08);
            box-sizing: border-box;
        }

        h2 {
            font-size: 16px;
            margin: 0 0 8px;
        }
        
        .mini-section-title {
            font-size: 14px;
            font-weight: 600;
            margin: 12px 0 6px;
            padding-top: 8px;
            border-top: 1px dashed #e0e0e0;
        }
        
        .mini-section-title:first-child {
             border-top: none;
             padding-top: 0;
             margin-top: 0;
        }

        .subtitle {
            font-size: 11px;
            color: #616161;
            margin-bottom: 8px;
        }

        label {
            display: block;
            font-size: 12px;
            margin: 6px 0 2px;
            font-weight: 600;
        }

        select, input[type="text"] {
            width: 100%;
            padding: 6px 8px;
            border-radius: 6px;
            border: 1px solid #c5cae9;
            font-size: 12px;
            box-sizing: border-box;
        }

        .btn {
            border-radius: 999px;
            border: none;
            padding: 6px 10px;
            font-size: 12px;
            cursor: pointer;
            margin-right: 6px;
        }

        .btn-primary {
            background: #283593;
            color: white;
        }

        .btn-secondary {
            background: #eeeeee;
            color: #212121;
        }

        .btn-primary:hover {
            background: #1a237e;
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        .button-row {
            display: flex;
            gap: 6px;
            margin-top: 8px;
            flex-wrap: wrap;
        }
        
        .list-small {
            font-size: 11px;
            padding-left: 14px;
            margin: 0 0 10px 0;
        }

        .list-small li {
            margin-bottom: 3px;
        }

        #resultContent {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding-top: 10px;
        }

        .art-card {
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 10px;
            background: #fafbff;
            display: flex;
            gap: 12px;
            font-size: 12px;
        }

        .art-image {
            flex: 0 0 150px;
            max-width: 150px;
        }

        .art-image img {
            width: 100%;
            height: auto;
            border-radius: 8px;
            object-fit: cover;
            cursor: pointer;
        }

        .art-info {
            flex: 1 1 auto;
        }

        .art-info h3 {
            font-weight: 700;
            font-size: 13px;
            margin-top: 0;
            margin-bottom: 4px;
        }

        .art-info p {
            margin: 4px 0;
            font-size: 11px;
        }

        .art-info strong {
            font-weight: 600;
        }

        .chips {
            margin-top: 6px;
        }
        
        .hashtag, .chip {
            display: inline-block;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 999px;
            background: #e3f2fd;
            color: #212121;
            margin-right: 4px;
            margin-bottom: 4px;
            border: 1px solid #bbdefb;
            cursor: pointer;
        }

        .back-controls {
            margin-top: 15px;
            font-size: 12px;
            padding: 8px;
            border-top: 1px dashed #c5cae9;
        }

        .no-result {
            margin-top: 10px;
            font-size: 12px;
            color: #b00020;
            padding: 8px;
            background: #ffebee;
            border-radius: 6px;
        }

        .step small {
             font-size: 10px;
             color: #757575;
             margin-bottom: 5px;
             display: block;
        }

        .hidden {
            display: none;
        }

        @media (max-width: 600px) {
            .art-card {
                flex-direction: column;
            }
            .art-image {
                max-width: 100%;
            }
        }

        /* ğŸ“¸ ì „ì²´ í™”ë©´ ì´ë¯¸ì§€ íŒì—… */
        #imageModal {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }
        #imageModal.hidden {
            display: none;
        }

        #imageModalContent {
            max-width: 90%;
            max-height: 90%;
            text-align: center;
            color: #ffffff;
        }

        #imageModalImg {
            max-width: 100%;
            max-height: 80vh;
            border-radius: 10px;
        }

        #imageModalCaption {
            margin-top: 8px;
            font-size: 13px;
        }

        #imageModalClose {
            position: absolute;
            top: 16px;
            right: 24px;
            font-size: 28px;
            color: #ffffff;
            cursor: pointer;
            font-weight: bold;
        }

        /* ğŸ“ ë©”ëª¨ ì˜ì—­ + ì—°ê´€ ì‘í’ˆ ìŠ¤íƒ€ì¼ (ëª¨ë‹¬) */
        #memoArea {
            margin-top: 12px;
            text-align: left;
        }

        .memo-box {
            background: rgba(255,255,255,0.08);
            padding: 8px 10px;
            border-radius: 8px;
            font-size: 12px;
        }

        .memo-box textarea {
            width: 100%;
            min-height: 70px;
            border-radius: 6px;
            border: 1px solid #c5cae9;
            font-size: 12px;
            padding: 6px;
            box-sizing: border-box;
            resize: vertical;
        }

        #relatedModal {
            margin-top: 12px;
            text-align: left;
        }

        .related-title {
            font-size: 13px;
            margin-bottom: 4px;
            font-weight: 600;
        }

        .related-list {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .related-card {
            width: 120px;
            font-size: 10px;
            background: rgba(255,255,255,0.08);
            border-radius: 8px;
            padding: 4px;
            box-sizing: border-box;
        }

        .related-card img {
            width: 100%;
            border-radius: 6px;
            cursor: pointer;
            display: block;
            margin-bottom: 4px;
        }

        .related-card-title {
            font-weight: 600;
        }

        .related-card-artist {
            opacity: 0.8;
        }

        /* ğŸ“ / ğŸ”— ì¹´ë“œ ì•ˆì—ì„œ ë°”ë¡œ ì‚¬ìš©í•˜ëŠ” ì¸ë¼ì¸ ì˜ì—­ */
        .memo-inline {
            margin-top: 8px;
            background: #eef2ff;
            border-radius: 8px;
            padding: 6px 8px;
            font-size: 11px;
        }

        .memo-inline textarea {
            width: 100%;
            min-height: 60px;
            border-radius: 6px;
            border: 1px solid #c5cae9;
            font-size: 11px;
            padding: 4px 6px;
            box-sizing: border-box;
            resize: vertical;
        }

        .memo-inline .memo-inline-title {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .related-inline {
            margin-top: 6px;
            font-size: 11px;
        }

        .related-inline-title {
            font-weight: 600;
            margin-bottom: 3px;
        }

        .related-inline-list {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
        }

        .related-inline-card {
            width: 82px;
            background: #e8eaf6;
            border-radius: 6px;
            padding: 3px;
            box-sizing: border-box;
        }

        .related-inline-card img {
            width: 100%;
            border-radius: 4px;
            cursor: pointer;
            display: block;
            margin-bottom: 2px;
        }

        .related-inline-card-title {
            font-size: 10px;
            font-weight: 600;
        }

        .related-inline-card-artist {
            font-size: 10px;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <header>
        <h1>ArtMix</h1>
        <p>ë‹¨ê³„ë³„ í•„í„°ë§, ì»¬ë ‰ì…˜, ì—°ì† ê°ìƒ, ì·¨í–¥ ê¸°ë°˜ ì¶”ì²œ, ì‚¬ìš©ì ìˆ˜ì •Â·ì¶”ê°€ ê¸°ëŠ¥ì„ í†µí•©í•œ ë¯¸ìˆ  í”Œë«í¼ í”„ë¡œí† íƒ€ì…ì…ë‹ˆë‹¤.</p>

        <!-- ğŸ” ë¡œê·¸ì¸/íšŒì›ê°€ì… ì˜ì—­ -->
        <div id="authArea">
            <span id="authStatus">ë¡œê·¸ì¸í•˜ì§€ ì•ŠìŒ (ë‚˜ë§Œì˜ ê³µê°„ì€ ë¡œê·¸ì¸ í›„ ì €ì¥ë©ë‹ˆë‹¤)</span>
            <input type="email" id="emailInput" placeholder="ì´ë©”ì¼" />
            <input type="password" id="passwordInput" placeholder="ë¹„ë°€ë²ˆí˜¸ (6ì ì´ìƒ)" />
            <button class="btn btn-secondary" id="signUpBtn">íšŒì›ê°€ì…</button>
            <button class="btn btn-primary" id="loginBtn">ë¡œê·¸ì¸</button>
            <button class="btn btn-secondary hidden" id="logoutBtn">ë¡œê·¸ì•„ì›ƒ</button>
        </div>
    </header>

<main class="app-container">
    <div class="main-content">
        <div class="step hidden panel" id="step1">
            <h2>1. ì„œì–‘ë¯¸ìˆ  / ë™ì–‘ë¯¸ìˆ  ì„ íƒ</h2>
            <small>ë¨¼ì € ì „ì²´ì ì¸ íë¦„ì„ ì •í•´ìš”.</small>
            <label for="traditionSelect">ë¯¸ìˆ  ë²”ì£¼</label>
            <select id="traditionSelect">
                <option value="">-- ì„ íƒí•˜ì„¸ìš” --</option>
                <option value="ì„œì–‘">ì„œì–‘ë¯¸ìˆ </option>
                <option value="ë™ì–‘">ë™ì–‘ë¯¸ìˆ </option>
            </select>
        </div>

        <div class="step hidden panel" id="stepRegion">
            <h2>1-2. ë™ì–‘ ë¯¸ìˆ  ì„¸ë¶€ ì„ íƒ</h2>
            <small>ë™ì–‘ ë¯¸ìˆ ì„ ì„ íƒí–ˆë‹¤ë©´, ì§€ì—­ì„ ê³ ë¥´ì„¸ìš”.</small>
            <label for="regionSelect">ì§€ì—­</label>
            <select id="regionSelect">
                <option value="">-- ì„ íƒí•˜ì„¸ìš” --</option>
                <option value="í•œêµ­">í•œêµ­</option>
                <option value="ì¤‘êµ­">ì¤‘êµ­</option>
                <option value="ì¼ë³¸">ì¼ë³¸</option>
            </select>
        </div>

        <div class="step hidden panel" id="stepEra">
            <h2>2. ì‘í’ˆì˜ ì‹œëŒ€ ì„ íƒ</h2>
            <small>ì„ íƒí•œ ë²”ì£¼ ì•ˆì—ì„œ í•´ë‹¹í•˜ëŠ” ì‹œëŒ€ë§Œ ë³´ì—¬ì¤˜ìš”. (âŒ˜ ë˜ëŠ” Ctrl í‚¤ë¡œ ë³µìˆ˜ ì„ íƒ ê°€ëŠ¥)</small>
            <label for="eraSelect">ì‹œëŒ€</label>
            <select id="eraSelect" multiple size="6">
                <option value="__ALL__">ì „ì²´ ì„ íƒ</option>
            </select>
        </div>

        <div class="step hidden panel" id="stepMaterial">
            <h2>3. ì¬ë£Œ ë° ê¸°ë²• ì„ íƒ</h2>
            <small>í¬ê²Œ ì–´ë–¤ ì¬ë£Œ/í˜•ì‹ì„ ê°€ì§„ ì‘í’ˆì´ ì¢‹ì€ì§€ ê³¨ë¼ë³´ì„¸ìš”. (âŒ˜ ë˜ëŠ” Ctrl í‚¤ë¡œ ë³µìˆ˜ ì„ íƒ ê°€ëŠ¥)</small>
            <label for="materialSelect">ì¬ë£Œ / í˜•ì‹</label>
            <select id="materialSelect" multiple size="6">
                <option value="__ALL__">ì „ì²´ ì„ íƒ</option>
            </select>
        </div>

        <div class="step hidden panel" id="stepArtist">
            <h2>4. ì‘ê°€ ì„ íƒ</h2>
            <small>ì•ì—ì„œ ê³ ë¥¸ ì¡°ê±´ ì•ˆì— ë“¤ì–´ê°€ëŠ” ì‘ê°€ë§Œ ë‚˜ì™€ìš”. (âŒ˜ ë˜ëŠ” Ctrl í‚¤ë¡œ ë³µìˆ˜ ì„ íƒ ê°€ëŠ¥)</small>
            <label for="artistSelect">ì‘ê°€</label>
            <select id="artistSelect" multiple size="6">
                <option value="__ALL__">ì „ì²´ ì„ íƒ</option>
            </select>
        </div>

        <div class="step panel" id="stepKeyword">
            <h2>í‚¤ì›Œë“œ ê²€ìƒ‰</h2>
            <small>ë¶„ìœ„ê¸°, ì£¼ì œ ë“±ì„ í•´ì‹œíƒœê·¸ì²˜ëŸ¼ ì ì–´ë„ ì¢‹ì•„ìš”. ì˜ˆ: #ì¢…êµ #ì¸ì²´ #í’ê²½</small>
            <label for="keywordInput">í‚¤ì›Œë“œ</label>
            <input type="text" id="keywordInput" placeholder="ì‘í’ˆ ì´ë¦„, ì‘ê°€, ë‚´ìš©, í•´ì‹œíƒœê·¸ ë“±ìœ¼ë¡œ ê²€ìƒ‰">
            <div class="button-row" style="margin-top:12px;">
                <button class="btn btn-primary" id="recommendBtn">ì¶”ì²œ ê²°ê³¼ ë³´ê¸°</button>
            </div>
        </div>

        <div id="resultContainer" class="result panel hidden">
            <div class="result-header">
                <h2>âœ¨ ì¶”ì²œ ì‘í’ˆ ê²°ê³¼</h2>
            </div>
            <div class="filters-summary" id="filtersSummary"></div>
            <div id="resultContent"></div>

            <div class="back-controls">
                <button class="btn btn-secondary" id="resetBtn">ğŸ” ì²˜ìŒë¶€í„° ë‹¤ì‹œ</button>
            </div>
        </div>
    </div>
    
    <section class="panel">
        <h2>ë‚˜ë§Œì˜ ê³µê°„</h2>
        <div class="subtitle">ê° ê³„ì •ë§ˆë‹¤ ë”°ë¡œ ì €ì¥ë˜ëŠ” ì»¬ë ‰ì…˜, ì—°ì† ê°ìƒ, ìµœê·¼ ë³¸ ì‘í’ˆ, ì·¨í–¥ ê¸°ë°˜ ì¶”ì²œ, ì§ì ‘ ì‘í’ˆ ì¶”ê°€</div>

        <div>
            <div class="mini-section-title">ë‚´ ì»¬ë ‰ì…˜</div>
            <ul id="collectionList" class="list-small">
                <li>ì•„ì§ ì¶”ê°€ëœ ì‘í’ˆì´ ì—†ìŠµë‹ˆë‹¤.</li>
            </ul>
            <div class="button-row">
                <button class="btn btn-secondary" onclick="deleteSelectedCollection()">ì„ íƒ ì‚­ì œ</button>
                <button class="btn btn-secondary" onclick="clearCollection()">ì»¬ë ‰ì…˜ ë¹„ìš°ê¸°</button>
            </div>
        </div>

        <div>
            <div class="mini-section-title">ì—°ì† ê°ìƒ (í”Œë ˆì´ë¦¬ìŠ¤íŠ¸)</div>
            <ul id="playlist" class="list-small">
                <li>ì¬ìƒí•  ì‘í’ˆì´ ì—†ìŠµë‹ˆë‹¤.</li>
            </ul>
            <div class="button-row">
                <button class="btn btn-primary" onclick="playNext()">ë‹¤ìŒ ì‘í’ˆ ê°ìƒ</button>
                <button class="btn btn-secondary" onclick="deleteSelectedPlaylist()">ì„ íƒ ì‚­ì œ</button>
                <button class="btn btn-secondary" onclick="clearPlaylist()">í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ë¹„ìš°ê¸°</button>
            </div>
            <p id="nowPlaying" class="subtitle" style="margin-top:6px;">í˜„ì¬ ê°ìƒ ì¤‘: -</p>
            <!-- í˜„ì¬ ì¬ìƒ ì¤‘ ì‘í’ˆ ì¹´ë“œ -->
            <div id="nowPlayingDetail" class="art-card hidden"></div>
        </div>

        <div>
            <div class="mini-section-title">ìµœê·¼ ë³¸ ì‘í’ˆ</div>
            <p id="lastViewed" class="subtitle">ì•„ì§ ê°ìƒí•œ ì‘í’ˆì´ ì—†ìŠµë‹ˆë‹¤. ì‘í’ˆ ì¹´ë“œì˜ ì´ë¯¸ì§€ë¥¼ ëˆŒëŸ¬ë³´ì„¸ìš”.</p>
        </div>

        <div>
            <div class="mini-section-title">ë‚´ ì·¨í–¥ ê¸°ë°˜ ì¶”ì²œ</div>
            <p class="subtitle">
                ë‚´ ì»¬ë ‰ì…˜ì— ë“¤ì–´ìˆëŠ” ì‘í’ˆì˜ í‚¤ì›Œë“œ(íƒœê·¸)ì™€ ë§ì´ ê²¹ì¹˜ëŠ” ì‘í’ˆì„ ìœ„ì£¼ë¡œ ì¶”ì²œí•©ë‹ˆë‹¤.
            </p>
            <ul id="recommendList" class="list-small">
                <li>ì•„ì§ ë°ì´í„°ê°€ ì—†ì–´ ì¶”ì²œì„ ê³„ì‚°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</li>
            </ul>
            <button class="btn btn-secondary" onclick="updateRecommendations()">ì¶”ì²œ ë‹¤ì‹œ ê³„ì‚°</button>
        </div>

        <div>
            <div class="mini-section-title">ì‘í’ˆ ì¶”ê°€</div>
            <p class="subtitle">
                ì•„ë˜ ì…ë ¥ í¼ì€ <strong>â€˜ì‘í’ˆ ì¶”ê°€â€™ ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ</strong> ì—´ë¦½ë‹ˆë‹¤.
            </p>

            <!-- í† ê¸€ ë²„íŠ¼ -->
            <div class="button-row">
                <button class="btn btn-primary" onclick="toggleAddForm()">ì‘í’ˆ ì¶”ê°€</button>
            </div>

            <!-- ìˆ¨ê²¨ì§„ ì¶”ê°€ í¼ -->
            <div id="addForm" class="hidden" style="margin-top:8px;">
                <label for="newTitle">ì œëª©</label>
                <input id="newTitle" type="text" placeholder="ì˜ˆ: ë‚˜ë§Œì˜ ì‘í’ˆ ì œëª©" />

                <label for="newArtist">ì‘ê°€</label>
                <input id="newArtist" type="text" placeholder="ì˜ˆ: í™ê¸¸ë™" />

                <label for="newTradition">ë¯¸ìˆ  ë²”ì£¼ (ì„œì–‘/ë™ì–‘)</label>
                <select id="newTradition">
                    <option value="">(í˜„ì¬ ì„ íƒê°’ ì‚¬ìš© ë˜ëŠ” ê¸°ë³¸ê°’)</option>
                    <option value="ì„œì–‘">ì„œì–‘ë¯¸ìˆ </option>
                    <option value="ë™ì–‘">ë™ì–‘ë¯¸ìˆ </option>
                </select>

                <label for="newEra">ì‹œëŒ€</label>
                <input id="newEra" type="text" placeholder="ì˜ˆ: ë¥´ë„¤ìƒìŠ¤, ì¡°ì„  í›„ê¸°, í˜„ëŒ€ ë“±" />

                <label for="newMaterial">ì¬ë£Œ ë° ê¸°ë²•</label>
                <input id="newMaterial" type="text" placeholder="ì˜ˆ: ìœ í™”, ì§€ë³¸ ìˆ˜ë¬µë‹´ì±„, ëª©íŒí™” ë“±" />

                <label for="newTags">íƒœê·¸ (ì‰¼í‘œë¡œ êµ¬ë¶„)</label>
                <input id="newTags" type="text" placeholder="ì˜ˆ: ìˆ˜ë¬µí™”, ì„œì •ì , ì‚°ìˆ˜" />

                <label for="newImage">ì´ë¯¸ì§€ URL (ì„ íƒ)</label>
                <input id="newImage" type="text" placeholder="ì´ë¯¸ì§€ ë§í¬ë¥¼ ë„£ì§€ ì•Šìœ¼ë©´ ìë™ í”Œë ˆì´ìŠ¤í™€ë”ê°€ ì‚¬ìš©ë©ë‹ˆë‹¤." />

                <div class="button-row">
                    <button class="btn btn-primary" onclick="addArtwork()">ì¶”ê°€ ì™„ë£Œ</button>
                    <button class="btn btn-secondary" onclick="hideAddForm()">ì·¨ì†Œ</button>
                </div>
            </div>
        </div>
    </section>
</main>

    <!-- ğŸ“¸ ì „ì²´ í™”ë©´ ì´ë¯¸ì§€ íŒì—… ëª¨ë‹¬ -->
    <div id="imageModal" class="hidden">
        <div id="imageModalClose">&times;</div>
        <div id="imageModalContent">
            <img id="imageModalImg" src="" alt="">
            <p id="imageModalCaption"></p>
            <!-- ğŸ“ ì‘í’ˆ ë©”ëª¨ ì˜ì—­ -->
            <div id="memoArea"></div>
            <!-- ğŸ”— íƒœê·¸ ê¸°ë°˜ ì—°ê´€ ì‘í’ˆ -->
            <div id="relatedModal"></div>
        </div>
    </div>

    <footer>
        <p style="text-align: center; font-size: 11px; color: #757575; padding-top: 10px;">
            ArtMix ìŠ¤íƒ€ì¼ë¡œ ì¬êµ¬ì„±ëœ ë¯¸ìˆ  ì‘í’ˆ ì¶”ì²œ í”„ë¡œê·¸ë¨ + ê³„ì •ë³„ ë‚˜ë§Œì˜ ê³µê°„ ì €ì¥
        </p>
    </footer>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/11.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.0.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.0.0/firebase-auth-compat.js"></script>

    <script>
     const firebaseConfig = {
  apiKey: "AIzaSyBszYHu7au7d9hsSdSHRg7_AsUVE9DIOfI",
  authDomain: "artmix-app.firebaseapp.com",
  projectId: "artmix-app",
  storageBucket: "artmix-app.firebasestorage.app",
  messagingSenderId: "325350477860",
  appId: "1:325350477860:web:2bf6c78fda5d60dca548b1",
  measurementId: "G-R76GB4HHKK"
};


      firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore();
      const auth = firebase.auth();
    </script>

    <script>
    // ====== ê¸°ë³¸ ì‘í’ˆ ë°ì´í„° ======
    const artworks = [
        {
            "id": 1,
            "title": "ë¹—ì‚´ë¬´ëŠ¬í† ê¸°",
            "artist": "ë¯¸ìƒ",
            "tradition": "ë™ì–‘",
            "region": "í•œêµ­",
            "eraMain": "ì‹ ì„ê¸°",
            "material": "í† ê¸°, ì„ ê° ë¬´ëŠ¬",
            "year": "ê¸°ì›ì „ 4000â€“3000",
            "image": "https://via.placeholder.com/400x250?text=ë¹—ì‚´ë¬´ëŠ¬í† ê¸°",
            "description": "ì‹ ì„ê¸° ëŒ€í‘œ í† ê¸°, ë¹—ì‚´ë¬´ëŠ¬ ì¥ì‹",
            "hashtags": ["í† ê¸°", "ì‹ ì„ê¸°", "ì„ ì‚¬", "í•œêµ­"],
            "senseTags": ["ë‹¨ìˆœ", "ê±°ì¹œ", "ì—­ë™ì "],
            "docId": null
        },
        {
            "id": 49,
            "title": "ëª½ìœ ë„ì›ë„",
            "artist": "ì•ˆê²¬",
            "tradition": "ë™ì–‘",
            "region": "í•œêµ­",
            "eraMain": "ì¡°ì„  ì „ê¸°",
            "material": "ì§€ë³¸ ìˆ˜ë¬µë‹´ì±„",
            "year": "1447 ì¶”ì •",
            "image": "https://via.placeholder.com/400x250?text=ëª½ìœ ë„ì›ë„",
            "description": "ì´ìƒí–¥ ë„ì›, ê¶ì¤‘ í™”ì› ëŒ€í‘œì‘",
            "hashtags": ["íšŒí™”", "ìˆ˜ë¬µë‹´ì±„", "ì¡°ì„ ", "ì´ìƒí–¥", "ì•ˆê²¬", "í•œêµ­"],
            "senseTags": ["ëª½í™˜ì ", "ì„œì •ì ", "ë¶€ë“œëŸ¬ì›€"],
            "docId": null
        },
        {
            "id": 55,
            "title": "ì¸ì™•ì œìƒ‰ë„",
            "artist": "ì •ì„ ",
            "tradition": "ë™ì–‘",
            "region": "í•œêµ­",
            "eraMain": "ì¡°ì„  í›„ê¸°",
            "material": "ìˆ˜ë¬µë‹´ì±„",
            "year": "1751",
            "image": "https://via.placeholder.com/400x250?text=ì¸ì™•ì œìƒ‰ë„",
            "description": "ì„œìš¸ ì¸ì™•ì‚° ì‹¤ê²½, ì§„ê²½ì‚°ìˆ˜ ì ˆì •",
            "hashtags": ["íšŒí™”", "ìˆ˜ë¬µë‹´ì±„", "ì¡°ì„ ", "ì§„ê²½ì‚°ìˆ˜", "ì •ì„ ", "í•œêµ­"],
            "senseTags": ["ì—­ë™ì ", "ì°¨ê°€ìš´", "ê·¹ì "],
            "docId": null
        },
        {
            "id": 61,
            "title": "ì”¨ë¦„",
            "artist": "ê¹€í™ë„",
            "tradition": "ë™ì–‘",
            "region": "í•œêµ­",
            "eraMain": "ì¡°ì„  í›„ê¸°",
            "material": "ìˆ˜ë¬µë‹´ì±„",
            "year": "18C í›„ë°˜",
            "image": "https://via.placeholder.com/400x250?text=ì”¨ë¦„",
            "description": "ì—­ë™ì  í’ì†, ì„œë¯¼ ë¬¸í™”",
            "hashtags": ["íšŒí™”", "í’ì†í™”", "ì¡°ì„ ", "ì”¨ë¦„", "ê¹€í™ë„", "í•œêµ­", "ì—­ë™ì "],
            "senseTags": ["ì—­ë™ì ", "ë”°ëœ»í•œ", "í•´í•™"],
            "docId": null
        },
        {
            "id": 150,
            "title": "í›„ê°€ì¿  36ê²½ â€“ ê°€ë‚˜ê°€ì™€ì˜ í° íŒŒë„",
            "artist": "ê°€ì“°ì‹œì¹´ í˜¸ì¿ ì‚¬ì´",
            "tradition": "ë™ì–‘",
            "region": "ì¼ë³¸",
            "eraMain": "ì—ë„ì‹œëŒ€",
            "material": "ëª©íŒí™”",
            "year": "1831",
            "image": "https://via.placeholder.com/400x250?text=ê°€ë‚˜ê°€ì™€ì˜+í°+íŒŒë„",
            "description": "ìš°í‚¤ìš”ì— ì ˆì •, ë™ì„¸ì™€ ìƒ‰ì±„ ê°•ì¡°",
            "hashtags": ["ëª©íŒí™”", "ìš°í‚¤ìš”ì—", "ì—ë„", "íŒŒë„", "í˜¸ì¿ ì‚¬ì´", "ì¼ë³¸", "ì—­ë™ì "],
            "senseTags": ["ê·¸ë¡œí…ŒìŠ¤í¬", "ì°¨ê°€ìš´", "ì—­ë™ì "],
            "docId": null
        },
        {
            "id": 171,
            "title": "ëª¨ë‚˜ë¦¬ì",
            "artist": "ë ˆì˜¤ë‚˜ë¥´ë„ ë‹¤ ë¹ˆì¹˜",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ë¥´ë„¤ìƒìŠ¤",
            "material": "ìœ í™”",
            "year": "1503ê²½",
            "image": "https://via.placeholder.com/400x250?text=ëª¨ë‚˜ë¦¬ì",
            "description": "ìŠ¤í‘¸ë§ˆí†  ê¸°ë²•",
            "hashtags": ["íšŒí™”", "ìœ í™”", "ë¥´ë„¤ìƒìŠ¤", "ë‹¤ë¹ˆì¹˜", "ì´ˆìƒí™”", "ìœ ëŸ½"],
            "senseTags": ["ì‹ ë¹„", "ë¶€ë“œëŸ¬ì›€", "ë”°ëœ»í•œ"],
            "docId": null
        },
        {
            "id": 184,
            "title": "ì•¼ê²½",
            "artist": "ë ˜ë¸Œë€íŠ¸",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ë°”ë¡œí¬",
            "material": "ìœ í™”",
            "year": "1642",
            "image": "https://via.placeholder.com/400x250?text=ì•¼ê²½",
            "description": "ëª…ì•” ëŒ€ë¹„Â·ì§‘ë‹¨ ì´ˆìƒ",
            "hashtags": ["íšŒí™”", "ìœ í™”", "ë°”ë¡œí¬", "ë ˜ë¸Œë€íŠ¸", "ëª…ì•”", "ìœ ëŸ½", "ì–´ë‘ìš´"],
            "senseTags": ["ê·¹ì ", "ì–´ë‘ìš´", "ì°¨ê°€ìš´"],
            "docId": null
        },
        {
            "id": 227,
            "title": "ë³„ì´ ë¹›ë‚˜ëŠ” ë°¤",
            "artist": "ê³ í",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "í›„ê¸° ì¸ìƒì£¼ì˜",
            "material": "ìœ í™”",
            "year": "1889",
            "image": "https://via.placeholder.com/400x250?text=ë³„ì´+ë¹›ë‚˜ëŠ”+ë°¤",
            "description": "í‘œí˜„ì  í•˜ëŠ˜",
            "hashtags": ["íšŒí™”", "ìœ í™”", "í›„ê¸°ì¸ìƒì£¼ì˜", "ê³ í", "í•˜ëŠ˜", "ìœ ëŸ½", "ëª½í™˜ì ", "ë¶ˆì•ˆí•œ"],
            "senseTags": ["ëª½í™˜ì ", "ë¶ˆì•ˆí•œ", "ì—­ë™ì ", "ì°¨ê°€ìš´"],
            "docId": null
        },
        {
            "id": 251,
            "title": "ê¸°ì–µì˜ ì§€ì†",
            "artist": "ë‹¬ë¦¬",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ì „ìœ„ë¯¸ìˆ ",
            "material": "ìœ í™”",
            "year": "1931",
            "image": "https://via.placeholder.com/400x250?text=ê¸°ì–µì˜+ì§€ì†",
            "description": "ë…¹ëŠ” ì‹œê³„",
            "hashtags": ["íšŒí™”", "ìœ í™”", "ì „ìœ„ë¯¸ìˆ ", "ë‹¬ë¦¬", "ì´ˆí˜„ì‹¤ì£¼ì˜", "ëª½í™˜ì ", "ìœ ëŸ½"],
            "senseTags": ["ëª½í™˜ì ", "ì‹ ë¹„", "ê·¸ë¡œí…ŒìŠ¤í¬", "ì„œì •ì "],
            "docId": null
        },
        {
            "id": 258,
            "title": "ìº ë²¨ ìˆ˜í”„ ìº”",
            "artist": "ì›Œí™€",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ì „ìœ„ë¯¸ìˆ ",
            "material": "ì‹¤í¬ìŠ¤í¬ë¦°",
            "year": "1962",
            "image": "https://via.placeholder.com/400x250?text=ìº ë²¨+ìˆ˜í”„+ìº”",
            "description": "ì†Œë¹„ë¬¸í™”",
            "hashtags": ["íšŒí™”", "ì‹¤í¬ìŠ¤í¬ë¦°", "ì „ìœ„ë¯¸ìˆ ", "ì›Œí™€", "íŒì•„íŠ¸", "ì†Œë¹„", "ë¯¸êµ­"],
            "senseTags": ["ë‹¨ìˆœ", "ì°¨ê°€ìš´", "ëŒ€ì¤‘ì "],
            "docId": null
        }
    ,
        {
            "id": 259,
            "title": "íŒŒë¥´í…Œë…¼ ì‹ ì „ ì¡°ê°ë“¤",
            "artist": "í”¼ë””ì•„ìŠ¤",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ì„œì–‘ ê³ ëŒ€ ~ ì¤‘ì„¸",
            "material": "ì¡°ê°",
            "year": "ê¸°ì›ì „ 5C",
            "image": "https://via.placeholder.com/400x250?text=íŒŒë¥´í…Œë…¼+ì‹ ì „+ì¡°ê°ë“¤",
            "description": "ê³ ëŒ€ ê·¸ë¦¬ìŠ¤ / ì¡°ê° / ì‹ ì „ / í´ë˜ì‹",
            "hashtags": [
                "ê³ ëŒ€ ê·¸ë¦¬ìŠ¤",
                "ì¡°ê°",
                "ì‹ ì „",
                "í´ë˜ì‹"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 260,
            "title": "ë¼ì˜¤ì½˜ êµ°ìƒ",
            "artist": "ë¡œë„ìŠ¤ ì¡°ê°ê°€ë“¤",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ì„œì–‘ ê³ ëŒ€ ~ ì¤‘ì„¸",
            "material": "ì¡°ê°",
            "year": "ê¸°ì›ì „ 1C",
            "image": "https://via.placeholder.com/400x250?text=ë¼ì˜¤ì½˜+êµ°ìƒ",
            "description": "í—¬ë ˆë‹ˆì¦˜ / ì¡°ê° / ë“œë¼ë§ˆ / ì‹ í™”",
            "hashtags": [
                "í—¬ë ˆë‹ˆì¦˜",
                "ì¡°ê°",
                "ë“œë¼ë§ˆ",
                "ì‹ í™”"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 261,
            "title": "ëª¨ìì´í¬: ì•Œë ‰ì‚°ë” ì „íˆ¬",
            "artist": "ì•Œë ‰ì‚°ë” ëª¨ìì´í¬",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ì„œì–‘ ê³ ëŒ€ ~ ì¤‘ì„¸",
            "material": "ëª¨ìì´í¬",
            "year": "ê¸°ì›ì „ 1C",
            "image": "https://via.placeholder.com/400x250?text=ëª¨ìì´í¬:+ì•Œë ‰ì‚°ë”+ì „íˆ¬",
            "description": "í—¬ë ˆë‹ˆì¦˜ / ëª¨ìì´í¬ / ì „ìŸ / ê³ ëŒ€",
            "hashtags": [
                "í—¬ë ˆë‹ˆì¦˜",
                "ëª¨ìì´í¬",
                "ì „ìŸ",
                "ê³ ëŒ€"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 262,
            "title": "í‚¤ì•„ë¡œ ì˜ì ì„±ëª¨ì",
            "artist": "ë‘ì¹˜ì˜¤",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ì„œì–‘ ê³ ëŒ€ ~ ì¤‘ì„¸",
            "material": "íšŒí™”",
            "year": "13C",
            "image": "https://via.placeholder.com/400x250?text=í‚¤ì•„ë¡œ+ì˜ì+ì„±ëª¨ì",
            "description": "ì¤‘ì„¸ / ì´íƒˆë¦¬ì•„ / ì¢…êµí™” / í…œí˜ë¼",
            "hashtags": [
                "ì¤‘ì„¸",
                "ì´íƒˆë¦¬ì•„",
                "ì¢…êµí™”",
                "í…œí˜ë¼"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 263,
            "title": "ì•„ë ˆë‚˜ ì˜ˆë°°ë‹¹ í”„ë ˆìŠ¤ì½”",
            "artist": "ì¡°í† ",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ì„œì–‘ ê³ ëŒ€ ~ ì¤‘ì„¸",
            "material": "í”„ë ˆìŠ¤ì½”",
            "year": "1305",
            "image": "https://via.placeholder.com/400x250?text=ì•„ë ˆë‚˜+ì˜ˆë°°ë‹¹+í”„ë ˆìŠ¤ì½”",
            "description": "ì´ˆê¸° ë¥´ë„¤ìƒìŠ¤ / í”„ë ˆìŠ¤ì½” / ì¢…êµ / í‘œí˜„ì„±",
            "hashtags": [
                "ì´ˆê¸° ë¥´ë„¤ìƒìŠ¤",
                "í”„ë ˆìŠ¤ì½”",
                "ì¢…êµ",
                "í‘œí˜„ì„±"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 264,
            "title": "ìˆ˜íƒœê³ ì§€",
            "artist": "ë ˆì˜¤ë‚˜ë¥´ë„ ë‹¤ ë¹ˆì¹˜",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ë¥´ë„¤ìƒìŠ¤",
            "material": "ìœ í™”",
            "year": "1470s",
            "image": "https://via.placeholder.com/400x250?text=ìˆ˜íƒœê³ ì§€",
            "description": "ë¥´ë„¤ìƒìŠ¤ / ë ˆì˜¤ë‚˜ë¥´ë„ / ìœ í™” / ì¢…êµ",
            "hashtags": [
                "ë¥´ë„¤ìƒìŠ¤",
                "ë ˆì˜¤ë‚˜ë¥´ë„",
                "ìœ í™”",
                "ì¢…êµ"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 265,
            "title": "ìµœí›„ì˜ ë§Œì°¬",
            "artist": "ë ˆì˜¤ë‚˜ë¥´ë„ ë‹¤ ë¹ˆì¹˜",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ë¥´ë„¤ìƒìŠ¤",
            "material": "ë²½í™”",
            "year": "1498",
            "image": "https://via.placeholder.com/400x250?text=ìµœí›„ì˜+ë§Œì°¬",
            "description": "ë¥´ë„¤ìƒìŠ¤ / ë²½í™” / ì¢…êµ / êµ¬ì„±",
            "hashtags": [
                "ë¥´ë„¤ìƒìŠ¤",
                "ë²½í™”",
                "ì¢…êµ",
                "êµ¬ì„±"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 266,
            "title": "ë¹„ë„ˆìŠ¤ì˜ íƒ„ìƒ",
            "artist": "ë³´í‹°ì²¼ë¦¬",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ë¥´ë„¤ìƒìŠ¤",
            "material": "ìœ í™”",
            "year": "1485",
            "image": "https://via.placeholder.com/400x250?text=ë¹„ë„ˆìŠ¤ì˜+íƒ„ìƒ",
            "description": "ë¥´ë„¤ìƒìŠ¤ / ì‹ í™” / ìœ í™” / ì´ìƒí™”",
            "hashtags": [
                "ë¥´ë„¤ìƒìŠ¤",
                "ì‹ í™”",
                "ìœ í™”",
                "ì´ìƒí™”"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 267,
            "title": "ì•„í…Œë„¤ í•™ë‹¹",
            "artist": "ë¼íŒŒì—˜ë¡œ",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ë¥´ë„¤ìƒìŠ¤",
            "material": "ë²½í™”",
            "year": "1511",
            "image": "https://via.placeholder.com/400x250?text=ì•„í…Œë„¤+í•™ë‹¹",
            "description": "ë¥´ë„¤ìƒìŠ¤ / ë²½í™” / ê³ ì „ì£¼ì˜ / ì² í•™",
            "hashtags": [
                "ë¥´ë„¤ìƒìŠ¤",
                "ë²½í™”",
                "ê³ ì „ì£¼ì˜",
                "ì² í•™"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 268,
            "title": "ì²œì§€ì°½ì¡°",
            "artist": "ë¯¸ì¼ˆë€ì ¤ë¡œ",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ë¥´ë„¤ìƒìŠ¤",
            "material": "í”„ë ˆìŠ¤ì½”",
            "year": "1512",
            "image": "https://via.placeholder.com/400x250?text=ì²œì§€ì°½ì¡°",
            "description": "ë¥´ë„¤ìƒìŠ¤ / í”„ë ˆìŠ¤ì½” / êµíšŒ / ì¸ì²´",
            "hashtags": [
                "ë¥´ë„¤ìƒìŠ¤",
                "í”„ë ˆìŠ¤ì½”",
                "êµíšŒ",
                "ì¸ì²´"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 269,
            "title": "ì—˜ ê·¸ë ˆì½”ì˜ ì˜¤ë¥´ê°€ìŠ¤ ë°±ì‘ì˜ ë§¤ì¥",
            "artist": "ì—˜ ê·¸ë ˆì½”",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ë§¤ë„ˆë¦¬ì¦˜ ~ ë°”ë¡œí¬",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ì—˜+ê·¸ë ˆì½”ì˜+ì˜¤ë¥´ê°€ìŠ¤+ë°±ì‘ì˜+ë§¤ì¥",
            "description": "ë§¤ë„ˆë¦¬ì¦˜ / ì¢…êµ / ì‹ ë¹„ì„± / ìŠ¤í˜ì¸",
            "hashtags": [
                "ë§¤ë„ˆë¦¬ì¦˜",
                "ì¢…êµ",
                "ì‹ ë¹„ì„±",
                "ìŠ¤í˜ì¸"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 270,
            "title": "ë°”ì¿ ìŠ¤ì˜ ìŠ¹ë¦¬",
            "artist": "ì¹´ë¼ë°”ì¡°",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ë§¤ë„ˆë¦¬ì¦˜ ~ ë°”ë¡œí¬",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ë°”ì¿ ìŠ¤ì˜+ìŠ¹ë¦¬",
            "description": "ë°”ë¡œí¬ / í…Œë„¤ë¸Œë¦¬ì¦˜ / ê·¹ì  ì¡°ëª… / ì¸ë¬¼",
            "hashtags": [
                "ë°”ë¡œí¬",
                "í…Œë„¤ë¸Œë¦¬ì¦˜",
                "ê·¹ì  ì¡°ëª…",
                "ì¸ë¬¼"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 271,
            "title": "ìœ ë””íŠ¸ì™€ í™€ë¡œí˜ë¥´ë„¤ìŠ¤",
            "artist": "ì  í‹¸ë ˆìŠ¤í‚¤",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ë§¤ë„ˆë¦¬ì¦˜ ~ ë°”ë¡œí¬",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ìœ ë””íŠ¸ì™€+í™€ë¡œí˜ë¥´ë„¤ìŠ¤",
            "description": "ë°”ë¡œí¬ / í…Œë„¤ë¸Œë¦¬ì¦˜ / ì—¬ì„±ì£¼ì˜ / í­ë ¥ì„±",
            "hashtags": [
                "ë°”ë¡œí¬",
                "í…Œë„¤ë¸Œë¦¬ì¦˜",
                "ì—¬ì„±ì£¼ì˜",
                "í­ë ¥ì„±"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 272,
            "title": "ë¼ìŠ¤ ë©”ë‹ˆë‚˜ìŠ¤",
            "artist": "ë²¨ë¼ìŠ¤ì¼€ìŠ¤",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ë§¤ë„ˆë¦¬ì¦˜ ~ ë°”ë¡œí¬",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ë¼ìŠ¤+ë©”ë‹ˆë‚˜ìŠ¤",
            "description": "ë°”ë¡œí¬ / ìŠ¤í˜ì¸ / ê¶ì • / ë©”íƒ€íšŒí™”",
            "hashtags": [
                "ë°”ë¡œí¬",
                "ìŠ¤í˜ì¸",
                "ê¶ì •",
                "ë©”íƒ€íšŒí™”"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 273,
            "title": "ì§„ì£¼ ê·€ê±¸ì´ë¥¼ í•œ ì†Œë…€",
            "artist": "ë² ë¥´ë©”ë¥´",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ë§¤ë„ˆë¦¬ì¦˜ ~ ë°”ë¡œí¬",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ì§„ì£¼+ê·€ê±¸ì´ë¥¼+í•œ+ì†Œë…€",
            "description": "ë°”ë¡œí¬ / ë„¤ëœë€ë“œ / ì´ˆìƒ / ì •ì ",
            "hashtags": [
                "ë°”ë¡œí¬",
                "ë„¤ëœë€ë“œ",
                "ì´ˆìƒ",
                "ì •ì "
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 274,
            "title": "íœ˜ì¥ì˜ ì˜¤ë‹¬ë¦¬ìŠ¤í¬",
            "artist": "ì—¥ê·¸ë¥´",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ë¡œì½”ì½” ~ ì‹ ê³ ì „ì£¼ì˜ ~ ë‚­ë§Œì£¼ì˜",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=íœ˜ì¥ì˜+ì˜¤ë‹¬ë¦¬ìŠ¤í¬",
            "description": "ì‹ ê³ ì „ì£¼ì˜ / ëˆ„ë“œ / ë™ì–‘ì£¼ì˜ / ì„ ì  í‘œí˜„",
            "hashtags": [
                "ì‹ ê³ ì „ì£¼ì˜",
                "ëˆ„ë“œ",
                "ë™ì–‘ì£¼ì˜",
                "ì„ ì  í‘œí˜„"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 275,
            "title": "ì§„ì •í•œ ì‚¬ë‘ì˜ ìŠ¹ë¦¬",
            "artist": "í”„ë¼ê³ ë‚˜ë¥´",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ë¡œì½”ì½” ~ ì‹ ê³ ì „ì£¼ì˜ ~ ë‚­ë§Œì£¼ì˜",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ì§„ì •í•œ+ì‚¬ë‘ì˜+ìŠ¹ë¦¬",
            "description": "ë¡œì½”ì½” / ê·€ì¡± / ì‚¬ë‘ / ì¥ì‹ì ",
            "hashtags": [
                "ë¡œì½”ì½”",
                "ê·€ì¡±",
                "ì‚¬ë‘",
                "ì¥ì‹ì "
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 276,
            "title": "ë©”ë‘ì‚¬ í˜¸ì˜ ë—ëª©",
            "artist": "ì œë¦¬ì½”",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ë¡œì½”ì½” ~ ì‹ ê³ ì „ì£¼ì˜ ~ ë‚­ë§Œì£¼ì˜",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ë©”ë‘ì‚¬+í˜¸ì˜+ë—ëª©",
            "description": "ë‚­ë§Œì£¼ì˜ / ì‚¬ì‹¤ì  / ë¹„ê·¹ / ì •ì¹˜ì„±",
            "hashtags": [
                "ë‚­ë§Œì£¼ì˜",
                "ì‚¬ì‹¤ì ",
                "ë¹„ê·¹",
                "ì •ì¹˜ì„±"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 277,
            "title": "ë¯¼ì¤‘ì„ ì´ë„ëŠ” ììœ ì˜ ì—¬ì‹ ",
            "artist": "ë“¤ë¼í¬ë£¨ì•„",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ë¡œì½”ì½” ~ ì‹ ê³ ì „ì£¼ì˜ ~ ë‚­ë§Œì£¼ì˜",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ë¯¼ì¤‘ì„+ì´ë„ëŠ”+ììœ ì˜+ì—¬ì‹ ",
            "description": "ë‚­ë§Œì£¼ì˜ / í˜ëª… / ëŒ€í˜•íšŒí™” / ìƒì§•ì„±",
            "hashtags": [
                "ë‚­ë§Œì£¼ì˜",
                "í˜ëª…",
                "ëŒ€í˜•íšŒí™”",
                "ìƒì§•ì„±"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 278,
            "title": "ë¹™í•´",
            "artist": "í”„ë¦¬ë“œë¦¬íˆ",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ë¡œì½”ì½” ~ ì‹ ê³ ì „ì£¼ì˜ ~ ë‚­ë§Œì£¼ì˜",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ë¹™í•´",
            "description": "ë‚­ë§Œì£¼ì˜ / í’ê²½ / ìì—° / ê³ ë…",
            "hashtags": [
                "ë‚­ë§Œì£¼ì˜",
                "í’ê²½",
                "ìì—°",
                "ê³ ë…"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 279,
            "title": "ëŒê¹¨ëŠ” ì‚¬ëŒë“¤",
            "artist": "ì¿ ë¥´ë² ",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ì‚¬ì‹¤ì£¼ì˜ ~ ì¸ìƒì£¼ì˜",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ëŒê¹¨ëŠ”+ì‚¬ëŒë“¤",
            "description": "ì‚¬ì‹¤ì£¼ì˜ / ë…¸ë™ / ì‚¬íšŒë¹„íŒ",
            "hashtags": [
                "ì‚¬ì‹¤ì£¼ì˜",
                "ë…¸ë™",
                "ì‚¬íšŒë¹„íŒ"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 280,
            "title": "ì˜¬ë­í”¼ì•„",
            "artist": "ë§ˆë„¤",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ì‚¬ì‹¤ì£¼ì˜ ~ ì¸ìƒì£¼ì˜",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ì˜¬ë­í”¼ì•„",
            "description": "ì‚¬ì‹¤ì£¼ì˜/ì¸ìƒì£¼ì˜ / ë…¼ìŸì  / ëˆ„ë“œ",
            "hashtags": [
                "ì‚¬ì‹¤ì£¼ì˜/ì¸ìƒì£¼ì˜",
                "ë…¼ìŸì ",
                "ëˆ„ë“œ"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 281,
            "title": "í•´ë‹ì´ ì¸ìƒ",
            "artist": "ëª¨ë„¤",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ì‚¬ì‹¤ì£¼ì˜ ~ ì¸ìƒì£¼ì˜",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=í•´ë‹ì´+ì¸ìƒ",
            "description": "ì¸ìƒì£¼ì˜ / ë¹› / ë°”ë‹¤ / í’ê²½",
            "hashtags": [
                "ì¸ìƒì£¼ì˜",
                "ë¹›",
                "ë°”ë‹¤",
                "í’ê²½"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 282,
            "title": "ë¬¼ë­ ë“œ ë¼ ê°ˆë ˆíŠ¸",
            "artist": "ë¥´ëˆ„ì•„ë¥´",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ì‚¬ì‹¤ì£¼ì˜ ~ ì¸ìƒì£¼ì˜",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ë¬¼ë­+ë“œ+ë¼+ê°ˆë ˆíŠ¸",
            "description": "ì¸ìƒì£¼ì˜ / íŒŒë¦¬ / êµ°ì¤‘ / ë°ì€ ìƒ‰",
            "hashtags": [
                "ì¸ìƒì£¼ì˜",
                "íŒŒë¦¬",
                "êµ°ì¤‘",
                "ë°ì€ ìƒ‰"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 283,
            "title": "ë³„ì´ ë¹›ë‚˜ëŠ” ë°¤",
            "artist": "ë°˜ ê³ í",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ì‚¬ì‹¤ì£¼ì˜ ~ ì¸ìƒì£¼ì˜",
            "material": "ìœ í™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ë³„ì´+ë¹›ë‚˜ëŠ”+ë°¤",
            "description": "í›„ê¸°ì¸ìƒíŒŒ / ìœ í™” / í‘œí˜„ì  ë¶“ì§ˆ",
            "hashtags": [
                "í›„ê¸°ì¸ìƒíŒŒ",
                "ìœ í™”",
                "í‘œí˜„ì  ë¶“ì§ˆ"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 284,
            "title": "ëŒ€ìˆ˜ìš•ë„",
            "artist": "ì„¸ì”",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ì‚¬ì‹¤ì£¼ì˜ ~ ì¸ìƒì£¼ì˜",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ëŒ€ìˆ˜ìš•ë„",
            "description": "í›„ê¸°ì¸ìƒíŒŒ / êµ¬ì¡°ì  í˜•íƒœ / ìì—°",
            "hashtags": [
                "í›„ê¸°ì¸ìƒíŒŒ",
                "êµ¬ì¡°ì  í˜•íƒœ",
                "ìì—°"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 285,
            "title": "ì£„ì™€ ë²Œ",
            "artist": "ë­‰í¬",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ê·¼ëŒ€: ìƒì§•ì£¼ì˜ ~ ì…ì²´ì£¼ì˜ ~ ì¶”ìƒ",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ì£„ì™€+ë²Œ",
            "description": "í‘œí˜„ì£¼ì˜ / ì‹¬ë¦¬ / ë¶ˆì•ˆ / ìƒì§•",
            "hashtags": [
                "í‘œí˜„ì£¼ì˜",
                "ì‹¬ë¦¬",
                "ë¶ˆì•ˆ",
                "ìƒì§•"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 286,
            "title": "ì•„ë¹„ë‡½ì˜ ì•„ê°€ì”¨ë“¤",
            "artist": "í”¼ì¹´ì†Œ",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ê·¼ëŒ€: ìƒì§•ì£¼ì˜ ~ ì…ì²´ì£¼ì˜ ~ ì¶”ìƒ",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ì•„ë¹„ë‡½ì˜+ì•„ê°€ì”¨ë“¤",
            "description": "ì…ì²´ì£¼ì˜ / í˜ì‹  / ì¸ë¬¼ / í•´ì²´",
            "hashtags": [
                "ì…ì²´ì£¼ì˜",
                "í˜ì‹ ",
                "ì¸ë¬¼",
                "í•´ì²´"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 287,
            "title": "ê¸°íƒ€ë¥¼ ë“  ë‚¨ì",
            "artist": "ë¸Œë¼í¬",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ê·¼ëŒ€: ìƒì§•ì£¼ì˜ ~ ì…ì²´ì£¼ì˜ ~ ì¶”ìƒ",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ê¸°íƒ€ë¥¼+ë“ +ë‚¨ì",
            "description": "ì…ì²´ì£¼ì˜ / ì •ë¬¼ / ì¬êµ¬ì„±",
            "hashtags": [
                "ì…ì²´ì£¼ì˜",
                "ì •ë¬¼",
                "ì¬êµ¬ì„±"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 288,
            "title": "êµ¬ì„± VIII",
            "artist": "ì¹¸ë”˜ìŠ¤í‚¤",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ê·¼ëŒ€: ìƒì§•ì£¼ì˜ ~ ì…ì²´ì£¼ì˜ ~ ì¶”ìƒ",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=êµ¬ì„±+VIII",
            "description": "ì¶”ìƒ / ê¸°í•˜í•™ / ìƒ‰ì±„ / ìŒì•…ì ",
            "hashtags": [
                "ì¶”ìƒ",
                "ê¸°í•˜í•™",
                "ìƒ‰ì±„",
                "ìŒì•…ì "
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 289,
            "title": "ê²€ì€ ì‚¬ê°í˜•",
            "artist": "ë§ë ˆë¹„ì¹˜",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ê·¼ëŒ€: ìƒì§•ì£¼ì˜ ~ ì…ì²´ì£¼ì˜ ~ ì¶”ìƒ",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ê²€ì€+ì‚¬ê°í˜•",
            "description": "ì¶”ìƒ / ì ˆëŒ€ì£¼ì˜ / ë¯¸ë‹ˆë©€ / ëŸ¬ì‹œì•„ ì „ìœ„",
            "hashtags": [
                "ì¶”ìƒ",
                "ì ˆëŒ€ì£¼ì˜",
                "ë¯¸ë‹ˆë©€",
                "ëŸ¬ì‹œì•„ ì „ìœ„"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 290,
            "title": "ë¶„ìˆ˜",
            "artist": "ë’¤ìƒ¹",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "20ì„¸ê¸°: ë‹¤ë‹¤Â·ì´ˆí˜„ì‹¤ì£¼ì˜Â·ì¶”ìƒí‘œí˜„ì£¼ì˜",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ë¶„ìˆ˜",
            "description": "ë‹¤ë‹¤ / ë ˆë””ë©”ì´ë“œ / ê°œë…ë¯¸ìˆ ",
            "hashtags": [
                "ë‹¤ë‹¤",
                "ë ˆë””ë©”ì´ë“œ",
                "ê°œë…ë¯¸ìˆ "
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 291,
            "title": "ê¸°ì–µì˜ ì§€ì†",
            "artist": "ì‚´ë°”ë„ë¥´ ë‹¬ë¦¬",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "20ì„¸ê¸°: ë‹¤ë‹¤Â·ì´ˆí˜„ì‹¤ì£¼ì˜Â·ì¶”ìƒí‘œí˜„ì£¼ì˜",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ê¸°ì–µì˜+ì§€ì†",
            "description": "ì´ˆí˜„ì‹¤ì£¼ì˜ / ì‹œê°„ / ê¿ˆ / ì™œê³¡",
            "hashtags": [
                "ì´ˆí˜„ì‹¤ì£¼ì˜",
                "ì‹œê°„",
                "ê¿ˆ",
                "ì™œê³¡"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 292,
            "title": "í”¼ì—íƒ€(ê²Œë¥´ë‹ˆì¹´ ë³€í˜•)",
            "artist": "í”¼ì¹´ì†Œ",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "20ì„¸ê¸°: ë‹¤ë‹¤Â·ì´ˆí˜„ì‹¤ì£¼ì˜Â·ì¶”ìƒí‘œí˜„ì£¼ì˜",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=í”¼ì—íƒ€(ê²Œë¥´ë‹ˆì¹´+ë³€í˜•)",
            "description": "ì „ìŸ / ìŠ¤í˜ì¸ / ì´ˆí˜„ì‹¤ì  / ì •ì¹˜ì„±",
            "hashtags": [
                "ì „ìŸ",
                "ìŠ¤í˜ì¸",
                "ì´ˆí˜„ì‹¤ì ",
                "ì •ì¹˜ì„±"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 293,
            "title": "No.5(1948)",
            "artist": "ì­ìŠ¨ í´ë¡",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "20ì„¸ê¸°: ë‹¤ë‹¤Â·ì´ˆí˜„ì‹¤ì£¼ì˜Â·ì¶”ìƒí‘œí˜„ì£¼ì˜",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=No.5(1948)",
            "description": "ì¶”ìƒí‘œí˜„ì£¼ì˜ / ë“œë¦¬í•‘ / ì œìŠ¤ì²˜ / ë¯¸êµ­",
            "hashtags": [
                "ì¶”ìƒí‘œí˜„ì£¼ì˜",
                "ë“œë¦¬í•‘",
                "ì œìŠ¤ì²˜",
                "ë¯¸êµ­"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 294,
            "title": "ì—¬ì„±ê³¼ ìƒˆ",
            "artist": "ë¯¸ë¡œ",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "20ì„¸ê¸°: ë‹¤ë‹¤Â·ì´ˆí˜„ì‹¤ì£¼ì˜Â·ì¶”ìƒí‘œí˜„ì£¼ì˜",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ì—¬ì„±ê³¼+ìƒˆ",
            "description": "ì´ˆí˜„ì‹¤ì£¼ì˜ / ìƒì§• / ë‹¨ìˆœí™” / ì¶”ìƒ",
            "hashtags": [
                "ì´ˆí˜„ì‹¤ì£¼ì˜",
                "ìƒì§•",
                "ë‹¨ìˆœí™”",
                "ì¶”ìƒ"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 295,
            "title": "ìº ë²¨ ìˆ˜í”„ ìº”",
            "artist": "ì•¤ë”” ì›Œí™€",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ì „í›„ í˜„ëŒ€ë¯¸ìˆ ",
            "material": "ì‹¤í¬ìŠ¤í¬ë¦°",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ìº ë²¨+ìˆ˜í”„+ìº”",
            "description": "íŒì•„íŠ¸ / ì†Œë¹„ë¬¸í™” / ì‹¤í¬ìŠ¤í¬ë¦°",
            "hashtags": [
                "íŒì•„íŠ¸",
                "ì†Œë¹„ë¬¸í™”",
                "ì‹¤í¬ìŠ¤í¬ë¦°"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 296,
            "title": "ëŸ¬ë¸Œ LOVE ì¡°ê°",
            "artist": "ë¡œë²„íŠ¸ ì¸ë””ì• ë‚˜",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ì „í›„ í˜„ëŒ€ë¯¸ìˆ ",
            "material": "ì¡°ê°",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ëŸ¬ë¸Œ+LOVE+ì¡°ê°",
            "description": "íŒì•„íŠ¸ / ì¡°ê° / ì•„ì´ì½˜ / ê¸€ì",
            "hashtags": [
                "íŒì•„íŠ¸",
                "ì¡°ê°",
                "ì•„ì´ì½˜",
                "ê¸€ì"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 297,
            "title": "ë¬´ì œ(Primary Structures)",
            "artist": "ë„ë„ë“œ ì €ë“œ",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ì „í›„ í˜„ëŒ€ë¯¸ìˆ ",
            "material": "ì¡°ê°",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ë¬´ì œ(Primary+Structures)",
            "description": "ë¯¸ë‹ˆë©€ë¦¬ì¦˜ / ì¡°ê° / ê¸°í•˜í•™",
            "hashtags": [
                "ë¯¸ë‹ˆë©€ë¦¬ì¦˜",
                "ì¡°ê°",
                "ê¸°í•˜í•™"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 298,
            "title": "One and Three Chairs",
            "artist": "ì¡°ì…‰ ì½”ìˆ˜ìŠ¤",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ì „í›„ í˜„ëŒ€ë¯¸ìˆ ",
            "material": "ì„¤ì¹˜",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=One+and+Three+Chairs",
            "description": "ê°œë…ë¯¸ìˆ  / ì–¸ì–´ / ìƒì§• / ì„¤ì¹˜",
            "hashtags": [
                "ê°œë…ë¯¸ìˆ ",
                "ì–¸ì–´",
                "ìƒì§•",
                "ì„¤ì¹˜"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 299,
            "title": "ë‹¨ìƒ‰í™”(From Line)",
            "artist": "ì´ìš°í™˜",
            "tradition": "ë™ì–‘",
            "region": "í•œêµ­",
            "eraMain": "ì „í›„ í˜„ëŒ€ë¯¸ìˆ ",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ë‹¨ìƒ‰í™”(From+Line)",
            "description": "í•œêµ­ í˜„ëŒ€ë¯¸ìˆ  / ë‹¨ìƒ‰í™” / ë°˜ë³µ / ìˆ˜í–‰ì„±",
            "hashtags": [
                "í•œêµ­ í˜„ëŒ€ë¯¸ìˆ ",
                "ë‹¨ìƒ‰í™”",
                "ë°˜ë³µ",
                "ìˆ˜í–‰ì„±"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 300,
            "title": "ì í™”",
            "artist": "ì•¼ìš”ì´ ì¿ ì‚¬ë§ˆ",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ì „í›„ í˜„ëŒ€ë¯¸ìˆ ",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ì í™”",
            "description": "í˜„ëŒ€ë¯¸ìˆ  / ì  / ë°˜ë³µ / í™˜ê°ì ",
            "hashtags": [
                "í˜„ëŒ€ë¯¸ìˆ ",
                "ì ",
                "ë°˜ë³µ",
                "í™˜ê°ì "
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 301,
            "title": "íƒœì–‘ì˜ íƒ‘",
            "artist": "ì˜¤ì¹´ëª¨í†  ë‹¤ë¡œ",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ì„¤ì¹˜Â·í¼í¬ë¨¼ìŠ¤Â·ë‰´ë¯¸ë””ì–´",
            "material": "ì¡°ê°",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=íƒœì–‘ì˜+íƒ‘",
            "description": "í˜„ëŒ€ / ì¡°ê° / ìƒì§• / ì¼ë³¸",
            "hashtags": [
                "í˜„ëŒ€",
                "ì¡°ê°",
                "ìƒì§•",
                "ì¼ë³¸"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 302,
            "title": "ì„œì¹˜(Search)",
            "artist": "ë°±ë‚¨ì¤€",
            "tradition": "ë™ì–‘",
            "region": "í•œêµ­",
            "eraMain": "ì„¤ì¹˜Â·í¼í¬ë¨¼ìŠ¤Â·ë‰´ë¯¸ë””ì–´",
            "material": "ë¹„ë””ì˜¤ì•„íŠ¸",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ì„œì¹˜(Search)",
            "description": "ë¹„ë””ì˜¤ì•„íŠ¸ / ë‰´ë¯¸ë””ì–´ / í•œêµ­ / ì‹¤í—˜",
            "hashtags": [
                "ë¹„ë””ì˜¤ì•„íŠ¸",
                "ë‰´ë¯¸ë””ì–´",
                "í•œêµ­",
                "ì‹¤í—˜"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 303,
            "title": "í´ë¼ìš°ë“œ ê²Œì´íŠ¸",
            "artist": "ì•„ë‹ˆì‹œ ì¹´í‘¸ì–´",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ì„¤ì¹˜Â·í¼í¬ë¨¼ìŠ¤Â·ë‰´ë¯¸ë””ì–´",
            "material": "ì¡°ê°",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=í´ë¼ìš°ë“œ+ê²Œì´íŠ¸",
            "description": "ì¡°ê° / ê³µê³µë¯¸ìˆ  / ë°˜ì‚¬ / ëŒ€í˜•ì‘í’ˆ",
            "hashtags": [
                "ì¡°ê°",
                "ê³µê³µë¯¸ìˆ ",
                "ë°˜ì‚¬",
                "ëŒ€í˜•ì‘í’ˆ"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 304,
            "title": "Weather Project",
            "artist": "ì˜¬ë¼í¼ ì—˜ë¦¬ì•„ìŠ¨",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ì„¤ì¹˜Â·í¼í¬ë¨¼ìŠ¤Â·ë‰´ë¯¸ë””ì–´",
            "material": "ì„¤ì¹˜",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=Weather+Project",
            "description": "ì„¤ì¹˜ë¯¸ìˆ  / ë¹› / ìì—° / ëª°ì…í˜•",
            "hashtags": [
                "ì„¤ì¹˜ë¯¸ìˆ ",
                "ë¹›",
                "ìì—°",
                "ëª°ì…í˜•"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 305,
            "title": "The Dinner Party",
            "artist": "ì£¼ë”” ì‹œì¹´ê³ ",
            "tradition": "ì„œì–‘",
            "region": "ì„œì–‘",
            "eraMain": "ì„¤ì¹˜Â·í¼í¬ë¨¼ìŠ¤Â·ë‰´ë¯¸ë””ì–´",
            "material": "ì„¤ì¹˜",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=The+Dinner+Party",
            "description": "ì—¬ì„±ì£¼ì˜ / ì„¤ì¹˜ / í…ìŠ¤íƒ€ì¼ / ì—­ì‚¬",
            "hashtags": [
                "ì—¬ì„±ì£¼ì˜",
                "ì„¤ì¹˜",
                "í…ìŠ¤íƒ€ì¼",
                "ì—­ì‚¬"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 306,
            "title": "í’ì†ë„: ì”¨ë¦„",
            "artist": "ê¹€í™ë„",
            "tradition": "ë™ì–‘",
            "region": "í•œêµ­",
            "eraMain": "ë™ì•„ì‹œì•„ + ê¸°íƒ€",
            "material": "í’ì†í™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=í’ì†ë„:+ì”¨ë¦„",
            "description": "ì¡°ì„  / í’ì†í™” / í•œêµ­ / ì¸ë¬¼í™”",
            "hashtags": [
                "ì¡°ì„ ",
                "í’ì†í™”",
                "í•œêµ­",
                "ì¸ë¬¼í™”"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 307,
            "title": "êµ°ë§ˆë„",
            "artist": "ê¸°ì¹´ì¿ ",
            "tradition": "ë™ì–‘",
            "region": "ì¼ë³¸",
            "eraMain": "ë™ì•„ì‹œì•„ + ê¸°íƒ€",
            "material": "íšŒí™”",
            "year": "ì—ë„ ì‹œëŒ€",
            "image": "https://via.placeholder.com/400x250?text=êµ°ë§ˆë„",
            "description": "ì¼ë³¸ / íšŒí™” / ë™ì–‘í™” / ë™ë¬¼",
            "hashtags": [
                "ì¼ë³¸",
                "íšŒí™”",
                "ë™ì–‘í™”",
                "ë™ë¬¼"
            ],
            "senseTags": [],
            "docId": null
        },
        {
            "id": 308,
            "title": "ì‚°ìˆ˜ë„",
            "artist": "ì•ˆíœ˜(è³ˆæ¹–)",
            "tradition": "ë™ì–‘",
            "region": "ì¤‘êµ­",
            "eraMain": "ë™ì•„ì‹œì•„ + ê¸°íƒ€",
            "material": "íšŒí™”",
            "year": "ì—°ë„ ë¯¸ìƒ",
            "image": "https://via.placeholder.com/400x250?text=ì‚°ìˆ˜ë„",
            "description": "ì¤‘êµ­ íšŒí™” / ì‚°ìˆ˜ / ë¨¹ / ìì—°",
            "hashtags": [
                "ì¤‘êµ­ íšŒí™”",
                "ì‚°ìˆ˜",
                "ë¨¹",
                "ìì—°"
            ],
            "senseTags": [],
            "docId": null
        }
    ];

    const state = {
        tradition: "",
        region: "",
        eraMain: [],
        material: [],
        artist: []
    };

    let collection = [];
    let playlist = [];
    let lastViewedId = null;
    let currentUser = null;  // ğŸ” í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ì
    let notes = {};          // ğŸ“ ì‘í’ˆë³„ ë©”ëª¨ { [artId]: "ë©”ëª¨ ë‚´ìš©" }

    const els = {
        step1: document.getElementById("step1"),
        stepRegion: document.getElementById("stepRegion"),
        stepEra: document.getElementById("stepEra"),
        stepMaterial: document.getElementById("stepMaterial"),
        stepArtist: document.getElementById("stepArtist"),
        stepKeyword: document.getElementById("stepKeyword"),
        traditionSelect: document.getElementById("traditionSelect"),
        regionSelect: document.getElementById("regionSelect"),
        eraSelect: document.getElementById("eraSelect"),
        materialSelect: document.getElementById("materialSelect"),
        artistSelect: document.getElementById("artistSelect"),
        keywordInput: document.getElementById("keywordInput"),
        recommendBtn: document.getElementById("recommendBtn"),
        resultContainer: document.getElementById("resultContainer"),
        resultContent: document.getElementById("resultContent"),
        filtersSummary: document.getElementById("filtersSummary"),
        resetBtn: document.getElementById("resetBtn"),
        collectionListEl: document.getElementById("collectionList"),
        playlistEl: document.getElementById("playlist"),
        nowPlayingEl: document.getElementById("nowPlaying"),
        nowPlayingDetailEl: document.getElementById("nowPlayingDetail"),
        recommendListEl: document.getElementById("recommendList"),
        lastViewedEl: document.getElementById("lastViewed"),
        // auth
        authStatus: document.getElementById("authStatus"),
        emailInput: document.getElementById("emailInput"),
        passwordInput: document.getElementById("passwordInput"),
        signUpBtn: document.getElementById("signUpBtn"),
        loginBtn: document.getElementById("loginBtn"),
        logoutBtn: document.getElementById("logoutBtn"),
        // image modal
        imageModal: document.getElementById("imageModal"),
        imageModalImg: document.getElementById("imageModalImg"),
        imageModalCaption: document.getElementById("imageModalCaption"),
        imageModalClose: document.getElementById("imageModalClose"),
        memoArea: document.getElementById("memoArea"),
        relatedModal: document.getElementById("relatedModal")
    };

    function show(el) { el.classList.remove("hidden"); }
    function hide(el) { el.classList.add("hidden"); }

    function toggleAddForm() {
        const form = document.getElementById("addForm");
        form.classList.toggle("hidden");
    }

    function hideAddForm() {
        const form = document.getElementById("addForm");
        form.classList.add("hidden");
    }

    function resetSelect(selectEl, placeholder) {
        selectEl.innerHTML = "";
        const opt = document.createElement("option");
        opt.value = "";
        opt.textContent = placeholder || "-- ì„ íƒí•˜ì„¸ìš” --";
        selectEl.appendChild(opt);
        
        if (selectEl.hasAttribute('multiple')) {
            const allOpt = document.createElement("option");
            allOpt.value = "__ALL__";
            allOpt.textContent = "ì „ì²´ ì„ íƒ";
            selectEl.appendChild(allOpt);
            Array.from(selectEl.options).forEach(opt => opt.selected = false);
        }
        selectEl.value = "";
    }

    function getSelectedValues(selectEl) {
        const selected = Array.from(selectEl.selectedOptions).map(o => o.value);
        if (selected.includes("__ALL__")) {
            return Array.from(selectEl.options)
                .map(o => o.value)
                .filter(v => v !== "" && v !== "__ALL__");
        }
        return selected.filter(v => v !== "" && v !== "__ALL__");
    }

    function filterArtworks(step) {
        return artworks.filter(a => {
            if (state.tradition && a.tradition !== state.tradition) return false;
            if (state.tradition === "ë™ì–‘" && state.region && a.region !== state.region) return false;
            if (step >= 2 && state.eraMain.length && !state.eraMain.includes(a.eraMain)) return false;
            if (step >= 3 && state.material.length && !state.material.includes(a.material)) return false;
            if (step >= 4 && state.artist.length && !state.artist.includes(a.artist)) return false;
            return true;
        });
    }

    function populateEraOptions() {
        const list = filterArtworks(1);
        const eras = Array.from(new Set(list.map(a => a.eraMain))).filter(e => e);
        resetSelect(els.eraSelect, "-- ì‹œëŒ€ë¥¼ ì„ íƒí•˜ì„¸ìš” --");
        eras.forEach(e => {
            const opt = document.createElement("option");
            opt.value = e;
            opt.textContent = e;
            els.eraSelect.appendChild(opt);
        });
        state.eraMain = [];
        hide(els.stepMaterial);
        hide(els.stepArtist);
        hide(els.resultContainer);
    }

    function populateMaterialOptions() {
        const list = filterArtworks(2);
        const materials = Array.from(new Set(list.map(a => a.material))).filter(m => m);
        resetSelect(els.materialSelect, "-- ì¬ë£Œ/í˜•ì‹ì„ ì„ íƒí•˜ì„¸ìš” --");
        materials.forEach(m => {
            const opt = document.createElement("option");
            opt.value = m;
            opt.textContent = m;
            els.materialSelect.appendChild(opt);
        });
        state.material = [];
        hide(els.stepArtist);
        hide(els.resultContainer);
    }

    function populateArtistOptions() {
        const list = filterArtworks(3);
        const artists = Array.from(new Set(list.map(a => a.artist))).filter(a => a);
        resetSelect(els.artistSelect, "-- ì‘ê°€ë¥¼ ì„ íƒí•˜ì„¸ìš” --");
        artists.forEach(ar => {
            const opt = document.createElement("option");
            opt.value = ar;
            opt.textContent = ar;
            els.artistSelect.appendChild(opt);
        });
        state.artist = [];
        hide(els.resultContainer);
    }

    function updateFiltersSummary() {
        const parts = [];
        if (state.tradition) parts.push(`**ë²”ì£¼:** ${state.tradition === "ì„œì–‘" ? "ì„œì–‘ë¯¸ìˆ " : "ë™ì–‘ë¯¸ìˆ "}`);
        if (state.tradition === "ë™ì–‘" && state.region) parts.push(`**ì§€ì—­:** ${state.region}`);
        if (state.eraMain.length) parts.push(`**ì‹œëŒ€:** ${state.eraMain.join(", ")}`);
        if (state.material.length) parts.push(`**ì¬ë£Œ/í˜•ì‹:** ${state.material.join(", ")}`);
        if (state.artist.length) parts.push(`**ì‘ê°€:** ${state.artist.join(", ")}`);
        const keyword = els.keywordInput.value.trim();
        if (keyword) parts.push(`**í‚¤ì›Œë“œ:** "${keyword}"`);

        if (parts.length) {
            els.filtersSummary.innerHTML = parts.join(" &nbsp; | &nbsp; ");
        } else {
            els.filtersSummary.innerHTML = `
                <div class="button-row">
                    <button class="btn btn-secondary" id="startFilterBtn">
                        ğŸ¨ ìƒì„¸ í•„í„°ë§ ì‹œì‘ (1ë‹¨ê³„ë¶€í„°)
                    </button>
                </div>
            `;
            document.getElementById("startFilterBtn").onclick = () => {
                show(els.step1);
                els.filtersSummary.innerHTML = "";
            };
        }
    }

    // ğŸ“¸ ì´ë¯¸ì§€ ì „ì²´ í™”ë©´ ëª¨ë‹¬ ì—´ê¸°
    function openImageModal(art) {
        if (!art) return;
        els.imageModalImg.src = art.image;
        els.imageModalImg.alt = art.title;
        els.imageModalCaption.textContent = `${art.title} (${art.artist || "-"})`;

        // ğŸ“ ë©”ëª¨ ì˜ì—­ ë Œë”ë§
        renderMemoArea(art);
        // ğŸ”— íƒœê·¸ ê¸°ë°˜ ì—°ê´€ ì‘í’ˆ ë Œë”ë§
        renderRelatedInModal(art);

        show(els.imageModal);
    }

    function closeImageModal() {
        hide(els.imageModal);
        els.imageModalImg.src = "";
        els.imageModalImg.alt = "";
        els.imageModalCaption.textContent = "";
        els.memoArea.innerHTML = "";
        els.relatedModal.innerHTML = "";
    }

    els.imageModalClose.addEventListener("click", closeImageModal);
    els.imageModal.addEventListener("click", (e) => {
        // ë°°ê²½ ì˜ì—­ í´ë¦­ ì‹œ ë‹«ê¸° (ì´ë¯¸ì§€/ë‚´ìš© í´ë¦­ì€ ìœ ì§€)
        if (e.target === els.imageModal) {
            closeImageModal();
        }
    });

    // ğŸ“ ë©”ëª¨ ì˜ì—­ ë Œë”ë§ (ëª¨ë‹¬ìš©)
    function renderMemoArea(art) {
        const memoArea = els.memoArea;
        if (!memoArea) return;

        // ë¡œê·¸ì¸ ì•ˆ ëì„ ë•Œ
        if (!currentUser) {
            memoArea.innerHTML = `
                <div class="memo-box">
                    ì´ ì‘í’ˆì— ëŒ€í•œ ê°œì¸ ë©”ëª¨ëŠ” <strong>ë¡œê·¸ì¸</strong> í›„ ì‘ì„±í•  ìˆ˜ ìˆì–´ìš”.
                </div>
            `;
            return;
        }

        const existing = (notes && notes[art.id]) || "";

        memoArea.innerHTML = `
            <div class="memo-box">
                <div style="margin-bottom:4px;"><strong>ğŸ“ ë‚´ ë©”ëª¨</strong> (ì´ ê³„ì •ì—ë§Œ ì €ì¥ë©ë‹ˆë‹¤)</div>
                <textarea id="memoTextarea">${existing.replace(/</g, "&lt;").replace(/>/g, "&gt;")}</textarea>
                <div style="margin-top:6px; text-align:right;">
                    <button class="btn btn-primary" style="font-size:11px; padding:4px 8px;"
                        onclick="saveMemo(${art.id})">ë©”ëª¨ ì €ì¥</button>
                </div>
            </div>
        `;
    }

    // ğŸ“ ë©”ëª¨ ì €ì¥ (ëª¨ë‹¬ìš©)
    function saveMemo(artId) {
        if (!currentUser) {
            alert("ë©”ëª¨ë¥¼ ì €ì¥í•˜ë ¤ë©´ ë¨¼ì € ë¡œê·¸ì¸í•´ ì£¼ì„¸ìš”.");
            return;
        }
        const textarea = document.getElementById("memoTextarea");
        if (!textarea) return;
        const text = textarea.value || "";
        notes[artId] = text;
        saveUserSpace();
        alert("ë©”ëª¨ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");
    }
    window.saveMemo = saveMemo;

    // ğŸ”— íƒœê·¸ ê¸°ë°˜ ì—°ê´€ ì‘í’ˆ ê³„ì‚° (ê³µí†µ)
    function getRelatedArtworks(baseArt, count = 3) {
        const baseTags = (baseArt.hashtags || []).map(t => String(t));
        if (!baseTags.length) return [];

        const scores = artworks
            .filter(a => a.id !== baseArt.id)
            .map(a => {
                let score = 0;
                (a.hashtags || []).forEach(tag => {
                    if (baseTags.includes(tag)) score += 1;
                });
                return { art: a, score };
            })
            .filter(item => item.score > 0)
            .sort((a, b) => b.score - a.score);

        return scores.slice(0, count).map(item => item.art);
    }

    // ğŸ”— ì—°ê´€ ì‘í’ˆ ëª¨ë‹¬ì— ë Œë”ë§
    function renderRelatedInModal(baseArt) {
        const container = els.relatedModal;
        if (!container) return;

        const related = getRelatedArtworks(baseArt, 3);

        if (!related.length) {
            container.innerHTML = `
                <div class="related-title">ğŸ”— ë¹„ìŠ·í•œ íƒœê·¸ì˜ ì—°ê´€ ì‘í’ˆ</div>
                <div style="font-size:11px; opacity:0.85;">ì•„ì§ ì´ ì‘í’ˆê³¼ íƒœê·¸ê°€ ê²¹ì¹˜ëŠ” ë‹¤ë¥¸ ì‘í’ˆì´ ì—†ì–´ìš”.</div>
            `;
            return;
        }

        const inner = related.map(a => `
            <div class="related-card">
                <img src="${a.image}"
                    alt="${a.title}"
                    onclick="(function(){ viewArtwork(${a.id}); openImageModal(getArt(${a.id})); })()"
                    onerror="this.onerror=null; this.src='https://via.placeholder.com/400x250?text=No+Image';">
                <div class="related-card-title">${a.title}</div>
                <div class="related-card-artist">${a.artist || "-"}</div>
            </div>
        `).join("");

        container.innerHTML = `
            <div class="related-title">ğŸ”— ë¹„ìŠ·í•œ íƒœê·¸ì˜ ì—°ê´€ ì‘í’ˆ</div>
            <div class="related-list">
                ${inner}
            </div>
        `;
    }

    /* ==========================
       ğŸ“ / ğŸ”— ì¹´ë“œ ì¸ë¼ì¸ ë²„ì „
       ========================== */

    function renderInlineMemo(art, container) {
        if (!container) return;

        if (!currentUser) {
            container.innerHTML = `
                <div class="memo-inline">
                    <div class="memo-inline-title">ğŸ“ ë‚´ ë©”ëª¨</div>
                    <div>ë¡œê·¸ì¸í•˜ë©´ ì´ ì‘í’ˆì— ëŒ€í•œ ê°œì¸ ë©”ëª¨ë¥¼ ë‚¨ê¸¸ ìˆ˜ ìˆì–´ìš”.</div>
                </div>
            `;
            return;
        }

        const existing = (notes && notes[art.id]) || "";

        container.innerHTML = `
            <div class="memo-inline">
                <div class="memo-inline-title">ğŸ“ ë‚´ ë©”ëª¨ (ì´ ê³„ì •ì—ë§Œ ì €ì¥)</div>
                <textarea id="memoInline-${art.id}">${existing.replace(/</g, "&lt;").replace(/>/g, "&gt;")}</textarea>
                <div style="margin-top:4px; text-align:right;">
                    <button class="btn btn-primary" style="font-size:10px; padding:3px 8px;"
                        onclick="saveInlineMemo(${art.id})">ë©”ëª¨ ì €ì¥</button>
                </div>
            </div>
        `;
    }

    function saveInlineMemo(artId) {
        if (!currentUser) {
            alert("ë©”ëª¨ë¥¼ ì €ì¥í•˜ë ¤ë©´ ë¨¼ì € ë¡œê·¸ì¸í•´ ì£¼ì„¸ìš”.");
            return;
        }
        const textarea = document.getElementById(`memoInline-${artId}`);
        if (!textarea) return;
        const text = textarea.value || "";
        notes[artId] = text;
        saveUserSpace();
        alert("ë©”ëª¨ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");
    }
    window.saveInlineMemo = saveInlineMemo;

    function renderInlineRelated(art, container) {
        if (!container) return;

        const related = getRelatedArtworks(art, 3);

        if (!related.length) {
            container.innerHTML = `
                <div class="related-inline">
                    <div class="related-inline-title">ğŸ”— ì—°ê´€ ì‘í’ˆ</div>
                    <div style="opacity:0.8;">ê³µìœ  íƒœê·¸ê°€ ìˆëŠ” ë‹¤ë¥¸ ì‘í’ˆì´ ì—†ì–´ìš”.</div>
                </div>
            `;
            return;
        }

        const inner = related.map(r => `
            <div class="related-inline-card">
                <img src="${r.image}"
                     alt="${r.title}"
                     onclick="(function(){ viewArtwork(${r.id}); openImageModal(getArt(${r.id})); })()"
                     onerror="this.onerror=null; this.src='https://via.placeholder.com/400x250?text=No+Image';">
                <div class="related-inline-card-title">${r.title}</div>
                <div class="related-inline-card-artist">${r.artist || "-"}</div>
            </div>
        `).join("");

        container.innerHTML = `
            <div class="related-inline">
                <div class="related-inline-title">ğŸ”— ì—°ê´€ ì‘í’ˆ</div>
                <div class="related-inline-list">
                    ${inner}
                </div>
            </div>
        `;
    }

    // ğŸ”§ ì‘í’ˆ ì •ë³´ ìˆ˜ì •
    function editArtwork(id) {
        const art = getArt(id);
        if (!art) return;

        let changed = false;

        while (true) {
            const choice = prompt(
`ìˆ˜ì •í•  í•­ëª©ì„ ì„ íƒí•˜ì„¸ìš”.
(ì—¬ëŸ¬ í•­ëª©ì„ ìˆ˜ì •í•˜ë ¤ë©´ ìˆ˜ì •ì´ ëë‚  ë•Œê¹Œì§€ ê³„ì† ì„ íƒí•˜ë©´ ë©ë‹ˆë‹¤.)

1. ì œëª©
2. ì‘ê°€
3. ì‹œëŒ€
4. ì¬ë£Œ/ê¸°ë²•
5. íƒœê·¸(í‚¤ì›Œë“œ)
6. ì´ë¯¸ì§€ URL
7. ë²”ì£¼/ì§€ì—­

0 ë˜ëŠ” ì·¨ì†Œ: ìˆ˜ì • ëë‚´ê¸°`,
                ""
            );

            if (choice === null || choice === "0") break;

            if (choice === "1") {
                let newTitle = prompt(
                    `ì œëª©ì„ ìˆ˜ì •í•©ë‹ˆë‹¤.\ní˜„ì¬: ${art.title || "(ì—†ìŒ)"}\n\nì‚­ì œí•˜ë ¤ë©´ ë‚´ìš©ì„ ëª¨ë‘ ì§€ìš°ê³  í™•ì¸ì„ ëˆ„ë¥´ì„¸ìš”.\në³€ê²½í•˜ì§€ ì•Šìœ¼ë ¤ë©´ ì·¨ì†Œ.`,
                    art.title || ""
                );
                if (newTitle !== null) {
                    art.title = newTitle.trim();
                    changed = true;
                }
            } else if (choice === "2") {
                let newArtist = prompt(
                    `ì‘ê°€ë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤.\ní˜„ì¬: ${art.artist || "(ì—†ìŒ)"}\n\nì‚­ì œí•˜ë ¤ë©´ ë‚´ìš©ì„ ëª¨ë‘ ì§€ìš°ê³  í™•ì¸.`,
                    art.artist || ""
                );
                if (newArtist !== null) {
                    art.artist = newArtist.trim();
                    changed = true;
                }
            } else if (choice === "3") {
                let newEra = prompt(
                    `ì‹œëŒ€ë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤.\ní˜„ì¬: ${art.eraMain || "(ì—†ìŒ)"}\n\nì‚­ì œí•˜ë ¤ë©´ ë‚´ìš©ì„ ëª¨ë‘ ì§€ìš°ê³  í™•ì¸.`,
                    art.eraMain || ""
                );
                if (newEra !== null) {
                    art.eraMain = newEra.trim();
                    changed = true;
                }
            } else if (choice === "4") {
                let newMaterial = prompt(
                    `ì¬ë£Œ/ê¸°ë²•ì„ ìˆ˜ì •í•©ë‹ˆë‹¤.\ní˜„ì¬: ${art.material || "(ì—†ìŒ)"}\n\nì‚­ì œí•˜ë ¤ë©´ ë‚´ìš©ì„ ëª¨ë‘ ì§€ìš°ê³  í™•ì¸.`,
                    art.material || ""
                );
                if (newMaterial !== null) {
                    art.material = newMaterial.trim();
                    changed = true;
                }
            } else if (choice === "5") {
                const currentTags = (art.hashtags || []).join(", ");
                let newTags = prompt(
`íƒœê·¸(í‚¤ì›Œë“œ)ë¥¼ ì‰¼í‘œ(,)ë¡œ êµ¬ë¶„í•´ ì…ë ¥í•˜ì„¸ìš”.
í˜„ì¬: ${currentTags || "(ì—†ìŒ)"}

ì•„ë¬´ê²ƒë„ ì…ë ¥í•˜ì§€ ì•Šê³  í™•ì¸ â†’ ëª¨ë“  íƒœê·¸ ì‚­ì œ
ì·¨ì†Œ â†’ ë³€ê²½ ì—†ìŒ`,
                    currentTags
                );
                if (newTags !== null) {
                    if (newTags.trim() === "") {
                        art.hashtags = [];
                    } else {
                        art.hashtags = newTags
                            .split(",")
                            .map(t => t.replace(/#/g, "").trim())
                            .filter(Boolean);
                    }
                    changed = true;
                }
            } else if (choice === "6") {
                let newImage = prompt(
`ì´ë¯¸ì§€ URLì„ ìˆ˜ì •í•©ë‹ˆë‹¤.
í˜„ì¬: ${art.image || "(ì—†ìŒ)"}

ì‚­ì œí•˜ë ¤ë©´ ë‚´ìš©ì„ ëª¨ë‘ ì§€ìš°ê³  í™•ì¸.
ì·¨ì†Œ â†’ ë³€ê²½ ì—†ìŒ`,
                    art.image || ""
                );
                if (newImage !== null) {
                    art.image = newImage.trim();
                    changed = true;
                }
            } else if (choice === "7") {
                let newTradition = prompt(
`ë²”ì£¼(ì„œì–‘/ë™ì–‘)ë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤.
í˜„ì¬: ${art.tradition || "(ì—†ìŒ)"}

ì˜ˆ: ì„œì–‘, ë™ì–‘`,
                    art.tradition || ""
                );
                if (newTradition !== null) {
                    art.tradition = newTradition.trim();
                    changed = true;
                }

                let newRegion = prompt(
`ì§€ì—­ì„ ìˆ˜ì •í•©ë‹ˆë‹¤.
í˜„ì¬: ${art.region || "(ì—†ìŒ)"}

ì˜ˆ: í•œêµ­, ì¤‘êµ­, ì¼ë³¸, ì„œì–‘ ë“±`,
                    art.region || ""
                );
                if (newRegion !== null) {
                    art.region = newRegion.trim();
                    changed = true;
                }
            } else {
                alert("0~7 ì‚¬ì´ì˜ ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
            }
        }

        if (!changed) return;

        // Firestoreì—ë„ ë°˜ì˜
        if (db && art.docId) {
            const updateData = {
                title: art.title || "",
                artist: art.artist || "",
                eraMain: art.eraMain || "",
                material: art.material || "",
                hashtags: art.hashtags || [],
                image: art.image || "",
                tradition: art.tradition || "",
                region: art.region || ""
            };
            db.collection("artworks").doc(art.docId).update(updateData)
                .then(() => console.log("ìˆ˜ì • ë‚´ìš© Firestore ì—…ë°ì´íŠ¸ ì™„ë£Œ"))
                .catch(err => console.error("Firestore ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:", err));
        }

        showResults();
        updateCollectionView();
        updateRecommendations();
    }
    window.editArtwork = editArtwork;

    function showResults() {
        let list = filterArtworks(4);
        const keywordRaw = els.keywordInput.value.trim();
        const keyword = keywordRaw.replace(/#/g, "").toLowerCase();

        if (keyword) {
            list = list.filter(a => {
                const text = [
                    a.title,
                    a.artist,
                    a.description,
                    (a.hashtags || []).join(" ")
                ].join(" ").toLowerCase();
                return text.includes(keyword);
            });
        }

        updateFiltersSummary();
        els.resultContent.innerHTML = "";

        if (!list.length) {
            const div = document.createElement("div");
            div.className = "no-result";
            div.textContent = "ì¡°ê±´ì— ë§ëŠ” ì‘í’ˆì„ ì°¾ì§€ ëª»í–ˆì–´ìš”. í‚¤ì›Œë“œë¥¼ ë¹„ìš°ê±°ë‚˜ ìƒìœ„ ë‹¨ê³„ë¥¼ ë‹¤ì‹œ ì„ íƒí•´ ë³´ì„¸ìš”.";
            els.resultContent.appendChild(div);
            show(els.resultContainer);
            return;
        }

        list.forEach(a => {
            const card = document.createElement("div");
            card.className = "art-card";

            const imgWrap = document.createElement("div");
            imgWrap.className = "art-image";
            const img = document.createElement("img");
            img.src = a.image;
            img.alt = a.title;
            img.onclick = () => {
                viewArtwork(a.id);
                openImageModal(a);
            };
            img.onerror = () => {
                img.onerror = null;
                img.src = "https://via.placeholder.com/400x250?text=No+Image";
            };
            imgWrap.appendChild(img);

            const info = document.createElement("div");
            info.className = "art-info";

            const h3 = document.createElement("h3");
            h3.textContent = `${a.title} (${a.year || "ì—°ë„ ë¯¸ìƒ"})`;
            info.appendChild(h3);

            const meta = document.createElement("p");
            meta.innerHTML = `<strong>ì‘ê°€:</strong> ${a.artist || "-"} / <strong>ì‹œëŒ€:</strong> ${a.eraMain || "-"} / <strong>ì¬ë£Œ:</strong> ${a.material || "-"}`;
            info.appendChild(meta);

            const desc = document.createElement("p");
            desc.textContent = a.description || "";
            info.appendChild(desc);

            if (a.hashtags && a.hashtags.length) {
                const chips = document.createElement("div");
                chips.className = "chips";
                a.hashtags.forEach(tag => {
                    const span = document.createElement("span");
                    span.className = "hashtag";
                    span.textContent = `#${tag}`;
                    span.onclick = () => {
                        els.keywordInput.value = tag;
                        showResults();
                    };
                    chips.appendChild(span);
                });
                info.appendChild(chips);
            }

            const btnRow = document.createElement("div");
            btnRow.className = "button-row";
            btnRow.style.marginTop = "6px";

            const editBtn = document.createElement("button");
            editBtn.className = "btn btn-secondary";
            editBtn.textContent = "ìˆ˜ì •";
            editBtn.style.fontSize = "10px";
            editBtn.onclick = () => editArtwork(a.id);

            const btnCollection = document.createElement("button");
            btnCollection.className = "btn btn-secondary";
            btnCollection.textContent = "ì»¬ë ‰ì…˜ì— ì¶”ê°€";
            btnCollection.style.fontSize = "10px";
            btnCollection.onclick = () => addToCollection(a.id);

            const btnPlaylist = document.createElement("button");
            btnPlaylist.className = "btn btn-primary";
            btnPlaylist.textContent = "ì—°ì† ê°ìƒì— ì¶”ê°€";
            btnPlaylist.style.fontSize = "10px";
            btnPlaylist.onclick = () => addToPlaylist(a.id);

            btnRow.appendChild(editBtn);
            btnRow.appendChild(btnCollection);
            btnRow.appendChild(btnPlaylist);
            info.appendChild(btnRow);

            /* ğŸ“ ì¹´ë“œ ì•„ë˜ ë©”ëª¨ ì˜ì—­ */
            const memoInlineContainer = document.createElement("div");
            renderInlineMemo(a, memoInlineContainer);
            info.appendChild(memoInlineContainer);

            /* ğŸ”— ì¹´ë“œ ì•„ë˜ ì—°ê´€ ì‘í’ˆ ì˜ì—­ */
            const relatedInlineContainer = document.createElement("div");
            renderInlineRelated(a, relatedInlineContainer);
            info.appendChild(relatedInlineContainer);

            card.appendChild(imgWrap);
            card.appendChild(info);
            els.resultContent.appendChild(card);
        });

        show(els.resultContainer);
    }

    function resetAll() {
        state.tradition = "";
        state.region = "";
        state.eraMain = [];
        state.material = [];
        state.artist = [];
        els.traditionSelect.value = "";
        els.regionSelect.value = "";
        resetSelect(els.eraSelect, "-- ì‹œëŒ€ë¥¼ ì„ íƒí•˜ì„¸ìš” --");
        resetSelect(els.materialSelect, "-- ì¬ë£Œë¥¼ ì„ íƒí•˜ì„¸ìš” --");
        resetSelect(els.artistSelect, "-- ì‘ê°€ë¥¼ ì„ íƒí•˜ì„¸ìš” --");
        els.keywordInput.value = "";

        hide(els.step1);
        hide(els.stepRegion);
        hide(els.stepEra);
        hide(els.stepMaterial);
        hide(els.stepArtist);

        show(els.stepKeyword);
        hide(els.resultContainer);

        els.filtersSummary.innerHTML = `
            <div class="button-row">
                <button class="btn btn-secondary" id="startFilterBtn">
                    ğŸ¨ ìƒì„¸ í•„í„°ë§ ì‹œì‘ (1ë‹¨ê³„ë¶€í„°)
                </button>
            </div>
        `;
        document.getElementById("startFilterBtn").onclick = () => {
            show(els.step1);
            els.filtersSummary.innerHTML = "";
        };
    }

    // ===== ë‚˜ë§Œì˜ ê³µê°„ ë¡œì§ =====
    function getArt(id) {
        return artworks.find(a => a.id === id);
    }

    // ğŸ” í˜„ì¬ ì‚¬ìš©ì ê³µê°„ ì €ì¥ (ì»¬ë ‰ì…˜/í”Œë ˆì´ë¦¬ìŠ¤íŠ¸/ìµœê·¼ ë³¸ ì‘í’ˆ/ë©”ëª¨)
    function saveUserSpace() {
        if (!currentUser || !db) return;
        const docRef = db.collection("userSpaces").doc(currentUser.uid);
        docRef.set({
            collection: collection,
            playlist: playlist,
            lastViewedId: lastViewedId || null,
            notes: notes || {},
            updatedAt: firebase.firestore.FieldValue.serverTimestamp()
        }, { merge: true })
        .then(() => {
            console.log("ì‚¬ìš©ì ê³µê°„ ì €ì¥ ì™„ë£Œ");
        })
        .catch(err => {
            console.error("ì‚¬ìš©ì ê³µê°„ ì €ì¥ ì˜¤ë¥˜: ", err);
        });
    }

    function loadUserSpaceForUser(uid) {
        if (!db) return;
        const docRef = db.collection("userSpaces").doc(uid);
        docRef.get().then(doc => {
            if (doc.exists) {
                const data = doc.data();
                collection = Array.isArray(data.collection) ? data.collection : [];
                playlist = Array.isArray(data.playlist) ? data.playlist : [];
                lastViewedId = data.lastViewedId || null;
                notes = data.notes || {};
            } else {
                collection = [];
                playlist = [];
                lastViewedId = null;
                notes = {};
            }
            updateCollectionView();
            updatePlaylistView();
            updateRecommendations();

            if (lastViewedId) {
                const art = getArt(lastViewedId);
                if (art) {
                    els.lastViewedEl.textContent =
                        `${art.title} (${art.artist || "-"}, ${art.year || "ì—°ë„ ë¯¸ìƒ"}) â€“ ${art.description || ""}`;
                } else {
                    els.lastViewedEl.textContent =
                        "ìµœê·¼ ë³¸ ì‘í’ˆ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
                }
            } else {
                els.lastViewedEl.textContent =
                    "ì•„ì§ ê°ìƒí•œ ì‘í’ˆì´ ì—†ìŠµë‹ˆë‹¤. ì‘í’ˆ ì¹´ë“œì˜ ì´ë¯¸ì§€ë¥¼ ëˆŒëŸ¬ë³´ì„¸ìš”.";
            }

            // í˜„ì¬ ì¬ìƒ ì¤‘ ì¹´ë“œëŠ” í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ê¸°ì¤€ìœ¼ë¡œ ìƒˆë¡œ ì‹œì‘
            renderNowPlayingCard(null);

            // ê²°ê³¼ê°€ ì´ë¯¸ ë–  ìˆë‹¤ë©´, ì¸ë¼ì¸ ë©”ëª¨/ì—°ê´€ ì‘í’ˆì„ notes ê¸°ì¤€ìœ¼ë¡œ ë‹¤ì‹œ ê·¸ë ¤ì£¼ê¸°
            if (!els.resultContainer.classList.contains("hidden")) {
                showResults();
            }
        }).catch(err => {
            console.error("ì‚¬ìš©ì ê³µê°„ ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜: ", err);
        });
    }

    function addToCollection(id) {
        if (!collection.includes(id)) {
            collection.push(id);
            updateCollectionView();
            updateRecommendations();
            saveUserSpace();
        }
    }

    function updateCollectionView() {
        els.collectionListEl.innerHTML = "";
        if (!collection.length) {
            els.collectionListEl.innerHTML = "<li>ì•„ì§ ì¶”ê°€ëœ ì‘í’ˆì´ ì—†ìŠµë‹ˆë‹¤.</li>";
            return;
        }
        collection.forEach(id => {
            const art = getArt(id);
            if (!art) return;
            const li = document.createElement("li");

            const checkbox = document.createElement("input");
            checkbox.type = "checkbox";
            checkbox.className = "collection-checkbox";
            checkbox.value = String(id);
            checkbox.style.marginRight = "4px";

            li.appendChild(checkbox);
            li.appendChild(document.createTextNode(`${art.title} (${art.artist || "-"})`));
            els.collectionListEl.appendChild(li);
        });
    }

    function clearCollection() {
        collection = [];
        updateCollectionView();
        updateRecommendations();
        saveUserSpace();
    }

    // âœ… ì„ íƒ ì‚­ì œ (ì»¬ë ‰ì…˜)
    function deleteSelectedCollection() {
        const checked = Array.from(document.querySelectorAll(".collection-checkbox:checked"));
        if (!checked.length) {
            alert("ì‚­ì œí•  ì‘í’ˆì„ ì„ íƒí•´ ì£¼ì„¸ìš”.");
            return;
        }
        const idsToRemove = checked.map(cb => parseInt(cb.value, 10));
        collection = collection.filter(id => !idsToRemove.includes(id));
        updateCollectionView();
        updateRecommendations();
        saveUserSpace();
    }
    window.deleteSelectedCollection = deleteSelectedCollection;

    function addToPlaylist(id) {
        playlist.push(id);
        updatePlaylistView();
        saveUserSpace();
    }

    function updatePlaylistView() {
        els.playlistEl.innerHTML = "";
        if (!playlist.length) {
            els.playlistEl.innerHTML = "<li>ì¬ìƒí•  ì‘í’ˆì´ ì—†ìŠµë‹ˆë‹¤.</li>";
            return;
        }
        playlist.forEach((id, idx) => {
            const art = getArt(id);
            if (!art) return;
            const li = document.createElement("li");

            const checkbox = document.createElement("input");
            checkbox.type = "checkbox";
            checkbox.className = "playlist-checkbox";
            checkbox.value = String(idx); // ì¸ë±ìŠ¤ë¡œ ê´€ë¦¬
            checkbox.style.marginRight = "4px";

            li.appendChild(checkbox);
            li.appendChild(document.createTextNode(`${idx + 1}. ${art.title} - ${art.artist || "-"}`));
            els.playlistEl.appendChild(li);
        });
    }

    // âœ… ì„ íƒ ì‚­ì œ (í”Œë ˆì´ë¦¬ìŠ¤íŠ¸)
    function deleteSelectedPlaylist() {
        const checked = Array.from(document.querySelectorAll(".playlist-checkbox:checked"));
        if (!checked.length) {
            alert("ì‚­ì œí•  ì‘í’ˆì„ ì„ íƒí•´ ì£¼ì„¸ìš”.");
            return;
        }
        const indicesToRemove = checked.map(cb => parseInt(cb.value, 10)).sort((a,b) => b - a);
        indicesToRemove.forEach(idx => {
            if (idx >= 0 && idx < playlist.length) {
                playlist.splice(idx, 1);
            }
        });
        updatePlaylistView();
        saveUserSpace();
    }
    window.deleteSelectedPlaylist = deleteSelectedPlaylist;

    function renderNowPlayingCard(art) {
        if (!art) {
            els.nowPlayingEl.textContent = "í˜„ì¬ ê°ìƒ ì¤‘: -";
            els.nowPlayingDetailEl.innerHTML = "";
            els.nowPlayingDetailEl.classList.add("hidden");
            return;
        }

        els.nowPlayingEl.textContent = `í˜„ì¬ ê°ìƒ ì¤‘: ${art.title} (${art.artist || "-"})`;

        els.nowPlayingDetailEl.innerHTML = `
            <div class="art-image">
                <img src="${art.image}" alt="${art.title}">
            </div>
            <div class="art-info">
                <h3>${art.title} (${art.year || "ì—°ë„ ë¯¸ìƒ"})</h3>
                <p><strong>ì‘ê°€:</strong> ${art.artist || "-"} / <strong>ì‹œëŒ€:</strong> ${art.eraMain || "-"} / <strong>ì¬ë£Œ:</strong> ${art.material || "-"}</p>
                <p>${art.description || ""}</p>
                ${
                    art.hashtags && art.hashtags.length
                    ? `<div class="chips">
                        ${art.hashtags.map(tag => `<span class="hashtag">#${tag}</span>`).join("")}
                       </div>`
                    : ""
                }
            </div>
        `;
        els.nowPlayingDetailEl.classList.remove("hidden");

        const img = els.nowPlayingDetailEl.querySelector("img");
        if (img) {
            img.onclick = () => {
                viewArtwork(art.id);
                openImageModal(art);
            };
            img.onerror = () => {
                img.onerror = null;
                img.src = "https://via.placeholder.com/400x250?text=No+Image";
            };
        }
    }

    function playNext() {
        if (!playlist.length) {
            renderNowPlayingCard(null);
            saveUserSpace();
            return;
        }
        const nextId = playlist.shift();
        const art = getArt(nextId);
        if (!art) {
            updatePlaylistView();
            renderNowPlayingCard(null);
            saveUserSpace();
            return;
        }
        renderNowPlayingCard(art);
        viewArtwork(nextId);
        updatePlaylistView();
        saveUserSpace();
    }

    function clearPlaylist() {
        playlist = [];
        updatePlaylistView();
        renderNowPlayingCard(null);
        saveUserSpace();
    }

    function viewArtwork(id) {
        const art = getArt(id);
        if (!art) return;
        lastViewedId = id;
        els.lastViewedEl.textContent =
            `${art.title} (${art.artist || "-"}, ${art.year || "ì—°ë„ ë¯¸ìƒ"}) â€“ ${art.description || ""}`;
        updateRecommendations();
        saveUserSpace();
    }

    function updateRecommendations() {
        els.recommendListEl.innerHTML = "";

        const tagCount = {};
        collection.forEach(id => {
            const art = getArt(id);
            if (!art) return;
            (art.hashtags || []).forEach(tag => {
                tagCount[tag] = (tagCount[tag] || 0) + 1;
            });
        });

        if (!Object.keys(tagCount).length) {
            els.recommendListEl.innerHTML =
                "<li>ì»¬ë ‰ì…˜ì— ì‘í’ˆì´ ìˆê±°ë‚˜, íƒœê·¸(í‚¤ì›Œë“œ)ê°€ ë“±ë¡ëœ ì‘í’ˆì´ ìˆì–´ì•¼ ì¶”ì²œì„ ê³„ì‚°í•  ìˆ˜ ìˆì–´ìš”.</li>";
            return;
        }

        const scores = artworks
            .filter(a => !collection.includes(a.id))
            .map(a => {
                let score = 0;
                (a.hashtags || []).forEach(tag => {
                    if (tagCount[tag]) score += tagCount[tag];
                });
                return { art: a, score };
            })
            .filter(item => item.score > 0)
            .sort((a, b) => b.score - a.score);

        if (!scores.length) {
            els.recommendListEl.innerHTML =
                "<li>ì»¬ë ‰ì…˜ê³¼ í‚¤ì›Œë“œê°€ ê²¹ì¹˜ëŠ” ë‹¤ë¥¸ ì‘í’ˆì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</li>";
            return;
        }

        scores.slice(0, 5).forEach(item => {
            const li = document.createElement("li");
            li.textContent =
                `${item.art.title} (${item.art.artist || "-"}) â€“ í‚¤ì›Œë“œ ê²¹ì¹¨ ì ìˆ˜: ${item.score}`;
            els.recommendListEl.appendChild(li);
        });
    }

    window.clearCollection = clearCollection;
    window.clearPlaylist = clearPlaylist;
    window.playNext = playNext;
    window.updateRecommendations = updateRecommendations;

    // Firestoreì—ì„œ ì‘í’ˆ ë¶ˆëŸ¬ì˜¤ê¸° + ê¸°ë³¸ ë°ì´í„°ì™€ ë¨¸ì§€
    function loadUserArtworksFromFirestore() {
      if (!db) return;

      db.collection("artworks").get()
        .then(snapshot => {
          snapshot.forEach(doc => {
            const data = doc.data();
            if (!data.title || !data.artist) return;

            // 1) ì œëª© + ì‘ê°€ê°€ ê°™ì€ ê¸°ë³¸ ì‘í’ˆì´ ì´ë¯¸ ìˆìœ¼ë©´ ê·¸ ê°ì²´ë¥¼ ì—…ë°ì´íŠ¸
            const existing = artworks.find(a =>
              a.title === data.title && a.artist === data.artist
            );

            if (existing) {
              existing.tradition = data.tradition || existing.tradition || "ì„œì–‘";
              existing.region = data.region || existing.region || (existing.tradition === "ë™ì–‘"
                ? (existing.region || "")
                : "ì„œì–‘");
              existing.eraMain = data.eraMain || existing.eraMain || "";
              existing.material = data.material || existing.material || "";
              existing.year = data.year || existing.year || "";
              existing.image = data.image || existing.image
                || ("https://via.placeholder.com/400x250?text=" + encodeURIComponent(existing.title));
              existing.description = data.description || existing.description || "";
              existing.hashtags = data.hashtags || existing.hashtags || [];
              existing.senseTags = data.senseTags || existing.senseTags || [];
              existing.docId = doc.id;   // ğŸ”‘ Firestore ë¬¸ì„œ ID ì—°ê²°
            } else {
              // 2) ê¸°ë³¸ ë°ì´í„°ì— ì—†ëŠ” ì‘í’ˆì´ë©´ ìƒˆë¡œ ì¶”ê°€ (ì‚¬ìš©ì ì¶”ê°€ ì‘í’ˆ)
              const currentIds = artworks.map(a => a.id || 0);
              const maxId = currentIds.length ? Math.max(...currentIds) : 0;
              const newId = maxId + 1;

              artworks.push({
                id: newId,
                title: data.title,
                artist: data.artist,
                tradition: data.tradition || "ì„œì–‘",
                region: data.region || (data.tradition === "ë™ì–‘" ? (data.region || "") : "ì„œì–‘"),
                eraMain: data.eraMain || "",
                material: data.material || "",
                year: data.year || "",
                image: data.image || ("https://via.placeholder.com/400x250?text=" + encodeURIComponent(data.title)),
                description: data.description || "ì‚¬ìš©ìê°€ ì§ì ‘ ì¶”ê°€í•œ ì‘í’ˆì…ë‹ˆë‹¤.",
                hashtags: data.hashtags || [],
                senseTags: data.senseTags || [],
                docId: doc.id
              });
            }
          });
          console.log("ğŸ”¥ Firestore + ê¸°ë³¸ ì‘í’ˆ ë¨¸ì§€ ì™„ë£Œ");
        })
        .catch(err => {
          console.error("Firestoreì—ì„œ ì‘í’ˆ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜: ", err);
        });
    }
    // ğŸ§· í•œ ë²ˆë§Œ ì‹¤í–‰í•´ì„œ ê¸°ë³¸ ì‘í’ˆë“¤ì„ Firestoreì— ì—…ë¡œë“œí•˜ëŠ” í•¨ìˆ˜
    function migrateAllBaseArtworksToFirestore() {
      if (!db) {
        alert("Firestoreê°€ ì¤€ë¹„ë˜ì§€ ì•Šì•˜ì–´ìš”.");
        return;
      }

      artworks.forEach(art => {
        // ì´ë¯¸ Firestoreì™€ ì—°ê²°ëœ ì‘í’ˆì€ ê±´ë„ˆë›°ê¸°
        if (art.docId) return;

        const data = {
          title: art.title,
          artist: art.artist,
          tradition: art.tradition || "ì„œì–‘",
          region: art.region || (art.tradition === "ë™ì–‘" ? (art.region || "") : "ì„œì–‘"),
          eraMain: art.eraMain || "",
          material: art.material || "",
          year: art.year || "",
          image: art.image || ("https://via.placeholder.com/400x250?text=" + encodeURIComponent(art.title)),
          description: art.description || "",
          hashtags: art.hashtags || [],
          senseTags: art.senseTags || []
        };

        if (!data.title || !data.artist) return;

        db.collection("artworks").add(data)
          .then(docRef => {
            console.log("âœ… ê¸°ë³¸ ì‘í’ˆ ì—…ë¡œë“œ:", art.title, docRef.id);
            art.docId = docRef.id;   // ë©”ëª¨ë¦¬ì—ì„œë¼ë„ ì—°ê²°
          })
          .catch(err => {
            console.error("âŒ ì—…ë¡œë“œ ì‹¤íŒ¨:", art.title, err);
          });
      });
    }

    // ì½˜ì†”ì—ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆê²Œ ì „ì—­ì— ê³µê°œ
    window.migrateAllBaseArtworksToFirestore = migrateAllBaseArtworksToFirestore;


    // ìƒˆ ì‘í’ˆ ì¶”ê°€ + Firestore ì €ì¥
    function addArtwork() {
        const titleInput = document.getElementById("newTitle");
        const artistInput = document.getElementById("newArtist");
        const tagsInput = document.getElementById("newTags");
        const imageInput = document.getElementById("newImage");
        const traditionInput = document.getElementById("newTradition");
        const eraInput = document.getElementById("newEra");
        const materialInput = document.getElementById("newMaterial");

        const title = titleInput.value.trim();
        const artist = artistInput.value.trim();
        const tagsRaw = tagsInput.value.trim();
        const image = imageInput.value.trim();
        const traditionField = traditionInput.value;
        const eraField = eraInput.value.trim();
        const materialField = materialInput.value.trim();

        if (!title || !artist) {
            alert("ì œëª©ê³¼ ì‘ê°€ëŠ” ë°˜ë“œì‹œ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
            return;
        }

        let tradition = traditionField || state.tradition || "ì„œì–‘";
        let region = tradition === "ë™ì–‘" ? (state.region || "") : "ì„œì–‘";

        const eraMain = eraField || state.eraMain[0] || "";
        const material = materialField || state.material[0] || "";
        const year = "";

        const hashtags = tagsRaw
            ? tagsRaw.split(",").map(t => t.trim()).filter(Boolean)
            : [];
        const senseTags = hashtags.slice();

        const currentIds = artworks.map(a => a.id || 0);
        const maxId = currentIds.length ? Math.max(...currentIds) : 0;
        const newId = maxId + 1;

        const description = "ì‚¬ìš©ìê°€ ì§ì ‘ ì¶”ê°€í•œ ì‘í’ˆì…ë‹ˆë‹¤.";

        const newArt = {
            id: newId,
            title,
            artist,
            tradition,
            region,
            eraMain,
            material,
            year,
            image: image || ("https://via.placeholder.com/400x250?text=" + encodeURIComponent(title)),
            description,
            hashtags,
            senseTags,
            docId: null
        };

        artworks.push(newArt);

        if (db) {
          db.collection("artworks").add({
            title,
            artist,
            tradition,
            region,
            eraMain,
            material,
            year,
            image: newArt.image,
            description,
            hashtags,
            senseTags
          }).then(docRef => {
            console.log("Firestoreì— ìƒˆ ì‘í’ˆ ì €ì¥ ì™„ë£Œ");
            newArt.docId = docRef.id;
          }).catch(err => {
            console.error("Firestore ì €ì¥ ì¤‘ ì˜¤ë¥˜: ", err);
          });
        }

        titleInput.value = "";
        artistInput.value = "";
        tagsInput.value = "";
        imageInput.value = "";
        traditionInput.value = "";
        eraInput.value = "";
        materialInput.value = "";

        hideAddForm();
        alert("ìƒˆ ì‘í’ˆì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤! ì¡°ê±´ì„ ì„ íƒí•˜ê³  'ì¶”ì²œ ê²°ê³¼ ë³´ê¸°'ë¥¼ ëˆŒëŸ¬ í™•ì¸í•´ ë³´ì„¸ìš”.");
    }
    window.addArtwork = addArtwork;

    // ===== ğŸ” Firebase Authentication ì´ë²¤íŠ¸ =====
    els.signUpBtn.addEventListener("click", () => {
        const email = els.emailInput.value.trim();
        const password = els.passwordInput.value.trim();
        if (!email || !password) {
            alert("ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
            return;
        }
        auth.createUserWithEmailAndPassword(email, password)
            .then(() => {
                alert("íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ìë™ìœ¼ë¡œ ë¡œê·¸ì¸ë©ë‹ˆë‹¤.");
            })
            .catch(err => {
                console.error(err);
                alert("íšŒì›ê°€ì… ì˜¤ë¥˜: " + err.message);
            });
    });

    els.loginBtn.addEventListener("click", () => {
        const email = els.emailInput.value.trim();
        const password = els.passwordInput.value.trim();
        if (!email || !password) {
            alert("ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
            return;
        }
        auth.signInWithEmailAndPassword(email, password)
            .catch(err => {
                console.error(err);
                alert("ë¡œê·¸ì¸ ì˜¤ë¥˜: " + err.message);
            });
    });

    els.logoutBtn.addEventListener("click", () => {
        auth.signOut().catch(err => {
            console.error(err);
            alert("ë¡œê·¸ì•„ì›ƒ ì˜¤ë¥˜: " + err.message);
        });
    });

    auth.onAuthStateChanged(user => {
        currentUser = user;
        if (user) {
            els.authStatus.textContent = `${user.email} ìœ¼ë¡œ ë¡œê·¸ì¸ë¨ (ë‚˜ë§Œì˜ ê³µê°„ì´ ì´ ê³„ì •ì— ì €ì¥ë©ë‹ˆë‹¤)`;
            els.logoutBtn.classList.remove("hidden");
            // ë¡œê·¸ì¸í•œ ì§í›„ ì‚¬ìš©ì ê³µê°„ ë¶ˆëŸ¬ì˜¤ê¸°
            loadUserSpaceForUser(user.uid);
        } else {
            els.authStatus.textContent = "ë¡œê·¸ì¸í•˜ì§€ ì•ŠìŒ (ë‚˜ë§Œì˜ ê³µê°„ì€ ë¡œê·¸ì¸ í›„ ì €ì¥ë©ë‹ˆë‹¤)";
            els.logoutBtn.classList.add("hidden");

            // ë¡œê·¸ì•„ì›ƒ ì‹œ í™”ë©´ì€ ì´ˆê¸°í™”í•˜ì§€ë§Œ, ì„œë²„ìª½ ë°ì´í„°ëŠ” ìœ ì§€
            collection = [];
            playlist = [];
            lastViewedId = null;
            notes = {};
            updateCollectionView();
            updatePlaylistView();
            updateRecommendations();
            renderNowPlayingCard(null);
            els.lastViewedEl.textContent =
                "ì•„ì§ ê°ìƒí•œ ì‘í’ˆì´ ì—†ìŠµë‹ˆë‹¤. ì‘í’ˆ ì¹´ë“œì˜ ì´ë¯¸ì§€ë¥¼ ëˆŒëŸ¬ë³´ì„¸ìš”.";

            if (!els.resultContainer.classList.contains("hidden")) {
                showResults();
            }
        }
    });

    // ì´ë²¤íŠ¸ ì—°ê²°: í•„í„° ë‹¨ê³„
    els.traditionSelect.addEventListener("change", () => {
        state.tradition = els.traditionSelect.value;
        state.region = "";
        if (!state.tradition) {
            hide(els.stepRegion);
            hide(els.stepEra);
            hide(els.stepMaterial);
            hide(els.stepArtist);
            hide(els.resultContainer);
            updateFiltersSummary();
            return;
        }
        if (state.tradition === "ë™ì–‘") {
            els.regionSelect.value = "";
            show(els.stepRegion);
            hide(els.stepEra);
            hide(els.stepMaterial);
            hide(els.stepArtist);
            hide(els.resultContainer);
        } else {
            state.region = "ì„œì–‘";
            hide(els.stepRegion);
            show(els.stepEra);
            populateEraOptions();
        }
        updateFiltersSummary();
    });

    els.regionSelect.addEventListener("change", () => {
        state.region = els.regionSelect.value;
        if (!state.region) {
            hide(els.stepEra);
            hide(els.stepMaterial);
            hide(els.stepArtist);
            hide(els.resultContainer);
            updateFiltersSummary();
            return;
        }
        show(els.stepEra);
        populateEraOptions();
        updateFiltersSummary();
    });

    els.eraSelect.addEventListener("change", () => {
        state.eraMain = getSelectedValues(els.eraSelect);
        show(els.stepMaterial);
        populateMaterialOptions();
        updateFiltersSummary();
    });

    els.materialSelect.addEventListener("change", () => {
        state.material = getSelectedValues(els.materialSelect);
        show(els.stepArtist);
        populateArtistOptions();
        updateFiltersSummary();
    });

    els.artistSelect.addEventListener("change", () => {
        state.artist = getSelectedValues(els.artistSelect);
        show(els.stepKeyword);
        hide(els.resultContainer);
        updateFiltersSummary();
    });

    els.recommendBtn.addEventListener("click", showResults);
    els.resetBtn.addEventListener("click", resetAll);

    // ì´ˆê¸°í™”
    resetAll();
    updateCollectionView();
    updatePlaylistView();
    updateRecommendations();
    renderNowPlayingCard(null);
    loadUserArtworksFromFirestore();
    </script>
</body>
</html>
